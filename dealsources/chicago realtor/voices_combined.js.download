function clear_pulldown(e,t,o){return e?(e.options.length=0,void(t&&o&&(e.options[0]=new Option(t,o)))):!1}function do_flag(e,t,o,n){if(t=t||null,e=e||null,!t||!e||parseInt(t.toString(10))!==parseInt(t)||!_content_type_def[e])return!1;var i=["s","d","o","n","r","of","b"];void 0!==o&&_.contains(i,o)||(o="r"),$.post(site_root+"q_flag.php",{ft:o,cid:t,ct:e},function(i){switch(parseInt(i.status)){case trulia.globals.AJAX_STATUS_SUCCESS:$(n).html("Flagged").css("color","#8f8f8f");break;case trulia.globals.AJAX_STATUS_FAILURE:alert(trulia.errors.DEFAULT_ERROR_MESSAGE);break;case trulia.errors.AUTH_MUST_LOG_IN:AuthPopup.setHeader("Sign in or register","to flag this content"),AuthPopup.setTrackingContext({flowName:"flag_content"}),AuthPopup.login().done(function(){return do_flag(e,t,o,n)})}close_flag_menu()})}function show_flag_menu(e,t,o,n){var i=getPosition(e),a;doNothing(e),set_mutex(trulia.globals.MENU_MUTEX,"flag_menu")||close_flag_menu(),"undefined"==typeof _can_moderate&&(_can_moderate="0"),_can_moderate=parseInt(_can_moderate),a=new Menu("Report this "+_content_type_def[t],"flag_menu"),"p"==t?(a.add_item("Offensive",function(){do_flag(t,o,"of",n)}),a.add_item("Spam",function(){do_flag(t,o,"s",n)}),a.add_item("Other",function(){do_flag(t,o,"r",n)})):(a.add_item("Spam",function(){do_flag(t,o,"s",n)}),a.add_item("Duplicate",function(){do_flag(t,o,"d",n)}),a.add_item("Off-topic",function(){do_flag(t,o,"o",n)}),a.add_item("Inappropriate",function(){do_flag(t,o,"n",n)}),_can_moderate&&a.add_item("Block this",function(){do_flag(t,o,"b",n)})),a.add_item('<a href="mailto:dmca@trulia.com?subject=Report copyright activity to Trulia">Copyright</a>'),a.add_close(),a.build(),a.position(i.x,i.y),a.show(),set_mutex(trulia.globals.MENU_MUTEX,"flag_menu")}function close_flag_menu(){var e=xb_get_element("flag_menu");e&&e.parentNode.removeChild(e),release_mutex(trulia.globals.MENU_MUTEX)}function alert_login_qa(e){var t="You must be logged in to "+e+".\nClick OK to log in or sign up for an account--it only takes a minute!";return confirm(t)}function qa_email_quick_sub(e,t){var o="qa_email_alert_quick_status",n="qa_email_alert_signup_button",i=xb_get_element(o),a={};return e.action.match(/q_qa_email_subscribe.php$/)?0!=parseInt(e.uid.value)||e.email&&is_valid_email(e.email.value)?"post"!=t||"Choose location"!=e.location.value&&""!=e.location.value||""!=e.categoryId.value?"post_and_question"!=t||e.fq.checked||e.freq_post.checked?(a.dataType="xml",a.type="post",a.data=$(e).serialize(),a.success=function(a){if(a.documentElement){var r=a.documentElement.getElementsByTagName("o")[0],s=parseInt(r.getAttribute("qs")),l=parseInt(r.getAttribute("bs"));if(4==s||4==l)if(1!=_trulia_logged_in&&alert_login_qa("set email alerts"))AuthPopup.setHeader("Trulia Voices Email Alerts"),AuthPopup.setTrackingContext({flowName:"quick_sub"+t}),AuthPopup.login().done(function(){$(e).submit()});else{var u;u=r.getAttribute("success_message")?r.getAttribute("success_message"):"There was an error with your subscription. Please verify your entries and try again.",i.innerHTML=u,add_class(i,"red_txt"),unhide(o,"block")}else remove_class(i,"red_txt"),i.innerHTML=r.getAttribute("success_message")?r.getAttribute("success_message"):'Success! Your email alert settings have been saved. Access all your email alerts in <a href="/account/alerts/voices/">My Email Alerts</a> anytime!',hide(n),unhide(o,"block"),e.fq.checked&&o_track_email_signup("question"),e.freq_post.checked&&o_track_email_signup("blog")}else alert(trulia.errors.DEFAULT_ERROR_MESSAGE)},$.ajax(e.action,a),!1):(add_class(i,"red_txt"),i.innerHTML="Please choose to receive questions, blog posts, or both.",unhide(o,"block"),setTimeout('hide("'+o+'")',5e3),!1):(alert("Please choose either a 'location' or a 'category'"),!1):(bad_email_alert(),!1):!1}function qa_email_signup_button_reset(){var e="qa_email_alert_quick_status",t="qa_email_alert_signup_button",o=xb_get_element(e);hide(e),unhide(t,"block")}function do_remove(e,t,o,n){if("q"!=t&&"a"!=t&&"c"!=t&&"b"!=t&&"g"!=t&&"r"!=t&&"d"!=t)return!1;if("undefined"==typeof _qa_remct_tkn)return!1;if(("undefined"==typeof n||1!=n)&&!confirm("Are you sure you want to delete this "+_content_type_def[t]+"? This action cannot be undone!"))return!1;var i=getHTTPObject(),a="tkn="+encodeURIComponent(_qa_remct_tkn)+"&cid="+encodeURIComponent(o)+"&ctp="+encodeURIComponent(t),r=site_root+"q_remct.php";i.open("POST",r,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(a),i.onreadystatechange=function(){if(4==i.readyState){var e=parseInt(i.responseText);switch(e){case 1:("b"==t||"g"==t)&&location.href.indexOf("/account/blog/")>=0?ProfileEditor.reload("blog_posts",!1,!0):location.reload(!0);break;case 555:window.location=site_root+"account/blog/";break;case-2:alert_login_qa("delete a "+_content_type_def[t])&&trulia.AuthPopup.show();break;default:var o={"-4":"Sorry--you may only delete your own "+_content_type_def[t]+"s.",100:_QA_ERROR_LABELS.not_allowed,"-1":trulia.errors.DEFAULT_ERROR_MESSAGE};alert("undefined"!=typeof o[e]?o[e]:o[-1])}}}}function is_default_location(e){var t=sanitize_input(e).toLowerCase();return t==sanitize_input(CONST.PLACEHOLDER_CITY_STATE_ZIP).toLowerCase()||t==sanitize_input(CONST.PLACEHOLDER_CITY_STATE_ZIP_ADDRESS).toLowerCase()||t==sanitize_input(CONST.PLACEHOLDER_CITY_STATE_ZIP_NEIGH_ADDRESS).toLowerCase()||t==sanitize_input(CONST.PLACEHOLDER_KEYWORD_NAME).toLowerCase()||t==sanitize_input(CONST.PLACEHOLDER_CITY_STATE_NEIGH_ZIP).toLowerCase()||t==sanitize_input(CONST.PLACEHOLDER_CITY_COUNTY_STATE).toLowerCase()}function choose_best_answer(e){var t=site_root+"q_qa_choose_best_answer.php?",o="aid="+e,n=getHTTPObject();n.open("GET",t+o,!0),n.onreadystatechange=function(){if(4==n.readyState)for(var e=get_ids_with_prefix("div","chba_"),t=0;t<e.length;++t){var o=xb_get_element(e[t]);o.parentNode.removeChild(o)}},n.send(null)}function Menu(e,t){this.title=e,this.menu_id=t,this.container=$$(t+"_container"),this.x=0,this.y=0,this.items=new Array,this.close=!1}function qa_row_hlt(e,t){t?toggle_class(e,"voices_result_row_hover","voices_result_row_nohover"):toggle_class(e,"voices_result_row_nohover","voices_result_row_hover")}function sanitize_input(e){return trim(e).replace(/[^A-Za-z0-9\.\-\_\'\s\,]/g,"")}function strip_tags(e){return e.replace(/<\s*\/?[^>]+>/g,"")}function toggle_homeroll_filters(){var e=xb_get_element("homeroll_hide_filters"),t=xb_get_element("homeroll_show_filters"),o=xb_get_element("homeroll_filters_wrapper");1==getCookie("voicesHomerollHideFiltersClicked")?(e&&(e.style.display="none"),t&&(t.style.display="block"),o&&(o.style.display="none")):(e&&(e.style.display="block"),t&&(t.style.display="none"),o&&(o.style.display="block"))}function qa_hide_stats(){if(clearTimeout(_profile_stats),!is_mutex_free(trulia.globals.STATS_LAYER_MUTEX)){var e=xb_get_element(trulia.mutexes[trulia.globals.STATS_LAYER_MUTEX]);e&&(e.className=e.className+" hidden"),release_mutex(trulia.globals.STATS_LAYER_MUTEX)}}function show_featured_guide_tab(e){var t,o,n="guide_feat_tabbed_",i=["home_buying","home_selling","financing","rentals","moving","foreclosure","design_and_decor"],a=$("#"+n+e+"_link");if(!a.hasClass("notlink")){a.addClass("notlink"),a.addClass("bold"),a.addClass("black"),block(n+e);for(var r in i)if(t=i[r],t!==e&&(o=$("#"+n+t+"_link"),o.hasClass("notlink")))return o.removeClass("notlink"),o.removeClass("bold"),o.removeClass("black"),void hide(n+t)}}function $$(e,t,o,n){return mkEl(e,t,o,n)}function block(e){unhide(e,"block")}function f_filterResults(e,t,o){var n=e?e:0;return t&&(!n||n>t)&&(n=t),o&&(!n||n>o)?o:n}function ContentRatingWidget(element){var self=this,elem=$(element);self.el=element,self.expanded=!1,self.is_up_down=elem.find(".up").length>0,self.widget_data=eval("("+self.el.getAttribute("data")+")"),self.previous_vote="",self.is_up_down?(elem.find(".up, .down").click(function(e){var t=$(e.target),o=t.hasClass("up")?"u":"n",n=elem.find("."+("u"==o?"down":"up")).first();self.vote(o,function(e){e.status>0&&(t.addClass("voted"),n.hasClass("voted")&&n.removeClass("voted"),t.hasClass("up")?(elem.siblings(".middle").find(".thanks_label").addClass("voted"),elem.siblings(".middle").find(".thanks_label").text("Thanked"),o_track_answer_rating_click("Thumbs up",!0)):(elem.siblings(".middle").find(".thanks_label").removeClass("voted"),elem.siblings(".middle").find(".thanks_label").text("Thank"),o_track_answer_rating_click("Thumbs down",!0)))})}),elem.siblings(".middle").find(".thanks_label").click(function(e){var t=$(e.target),o="u";self.vote(o,function(e){e.status>0&&(t.addClass("voted"),t.text("Thanked"),elem.find(".up").addClass("voted"),elem.find(".down").removeClass("voted"),o_track_answer_rating_click("Thanked",!0))})})):(self.widget_data.count&&self.expand(),elem.click(function(){self.vote("u")}))}function do_email_content(e,t){if(t="string"==typeof t?$("#"+t)[0]:t){var o=t.sp_s_name?trim(t.sp_s_name.value):"",n=t.sp_s_email?trim(t.sp_s_email.value):"",i,a=[],r=t.sp_r_email?t.sp_r_email:null,s=t.elements["sp_r_email[]"]?t.elements["sp_r_email[]"]:null,l="",u=0,c=0,d=t.sp_message?trim(t.sp_message.value):"",p=t.ruid?t.ruid.value:0,h=t.qid?parseInt(t.qid.value):0,f=t.ct?t.ct.value:null,m=t.ptype?t.ptype.value:"",g=t.sp_listingtype?t.sp_listingtype.value:"",v=t.sp_optin?t.sp_optin.checked:!1,w=t.sp_propertyId?t.sp_propertyId.value:"",y=t.is_rental_community?!0:!1,b=t.is_foreclosure&&1===parseInt(t.is_foreclosure.value)?!0:!1,k=t.sp_city?t.sp_city.value:"",C=t.sp_state?t.sp_state.value:"",S=t.sp_ahash?t.sp_ahash.value:"",E=t.sp_numbeds?t.sp_numbeds.value:"",T=t.sp_url?t.sp_url.value:"",R,P=location.href,x,A,M;if(s)if(u=0,s.length)for(M=0;M<s.length;M++)l=trim(s[M].value),a[u]=l,++u;else l=trim(s.value),is_valid_email(l)&&(a[u]=l,++u);else r&&(l=trim(r.value),is_valid_email(l)&&(a[0]=l));for(M=0;M<a.length;++M){if(i=a[M],""!==i&&!is_valid_email(i))return bad_email_alert(),s&&!s.length?s.focus():r.length>0&&r[r.length-1].focus(),!1;""!==i&&++c}if(1>c)return bad_email_alert(),s&&!s.length?s.focus():r&&r.focus(),!1;if(""!==n&&!is_valid_email(n))return bad_email_alert(),t.sp_s_email.focus(),!1;if(""===n||a.length<1)return bad_email_alert(),a.length<1?s&&!s.length?s.focus():r&&r.focus():t.sp_s_email.focus(),!1;switch(R=site_root,x={s:1,s_email:n,s_name:o,message:d,optin:v?"Y":"N",r_email:_.map(a,function(e){return e.toLowerCase()})},e){case"property":R+="email_page_property.php",x.propertyId=w,x.lt=g,x.city=k,x.state_code=C,y&&(x.is_rental_community=!0),P&&(x.current_url=P);break;case"url":R+="email_page_url.php",x.u=T,x.ct=f?f:document.title,h&&(x.qid=h);break;case"property_list":R+="email_list.php",x.ptype=m;break;default:return}$.post(R,x,function(i){var a=trulia.propertyData.get({id:x.propertyId,status:x.lt,stateCode:x.state_code}),r,s,l,u,c=$("#email_box_status_msg")[0],d;switch(i.status){case trulia.globals.AJAX_STATUS_SUCCESS:if(r="Your email was sent.",$(t).trigger("send_to_friend:success"),"property"!=e){if(DOMUtils.fill_element("email_box_status_msg",r),hide("email_box_form"),block("email_box_status"),u=$("#email_box")[0],u&&(DOMUtils.hide_selects_by_el(u),u.style.height="","url"==e&&"send_url_form"==t.id)){var _=$("#send_page_to_friend_popup")[0];_&&DOMUtils.hide_selects_by_el(_)}return}if("mytrulia"==trulia.page_name||!_supports_my_trulia||a.isForeclosure)return l=$("#contact_send_to_friend_popup"),s=l.length?l.find(".hd"):$("#send_property_to_friend_email_popup_popup_header"),s.html("Success!"),$(t).parents("#sp_main").siblings("#send_property_mail_box_status").find("#send_property_email_box_status_msg").html(r),$(t).closest("#send_property_email_box_form").hide(),$(t).parents("#sp_main").siblings("#send_property_mail_box_status").removeClass("gone hidden").css({display:"block"}),void("mytrulia"==trulia.page_name&&(_num_friend_emails=1));d=function(i,r){if($(document).trigger("shareProperty.legacy",[a]),r="boolean"==typeof r?r:!1,"property"==e&&"email_property_form"==t.id){if(!_trulia_logged_in)return $(document).one("loggedInDestroy.authPopup",function(e,t){save_property(a,null,null,"For Rent"==a.status?"save_favorite":"follow",null,t,{})}),void trulia.AuthPopup.show({id:"send_to_friend_save_"+("For Rent"==g?"rental":"property"),loginCopy:"For Rent"==g?"Log in to find more homes like this in "+k+".":null,loginGreeting:o?"Welcome back "+o+". Seems like you like this place!":null},{email:n});close_all_menus("send_property_to_friend_email_popup"),save_property({id:w,stateCode:C,status:g,hash:S},null,null,"For Rent"==a.status?"save_favorite":"follow","For Rent"==a.status?!1:!0,null,{})}},_trulia_logged_in?d():trulia.auth.checkEmailExists(n,function(e){var t="details"==trulia.page_name?"pdp_send_to_friend":"";trulia.photoPlayerModal&&"undefined"!=typeof trulia.photoPlayerModal.moduleName&&(t="pdp_photoplayer_modal_send_to_friend"),e?($(document).one("showLogin.authPopup",function(){$("#login_email_field").val(n),$("#login_signup_link").hide()}),d()):($(document).unbind("completeAutoRegister.auth").one("completeAutoRegister.auth",function(){d(!0,!0)}),trulia.auth.autoRegister(n,o,"","share",t))});break;case trulia.globals.AJAX_STATUS_FAILURE:r="Sorry -- An error occurred while sending your email.",c?DOMUtils.fill_element("email_box_status_msg",r):alert(r)}})}}function build_email_page_url(e,t,o,n,i,a){t=t||location.href;var r=clone_obj(e),s={u:t,pt:o,ct:i,share:a?"Y":"N"};doNothing(e),n&&(s.qid=n),$.post(site_root+"email_page_url.php",s,function(e){switch(e.status){case trulia.globals.AJAX_STATUS_SUCCESS:if(!e.html)return void alert(trulia.errors.DEFAULT_ERROR_MESSAGE);var t=$("#email_box")[0];t&&t.parentNode.removeChild(t),t=$('<div id="email_box">'+e.html+"</div>"),$("body").append(t),show_pos_menu(r,"send_page_to_friend_popup",-380,10);break;case trulia.globals.AJAX_STATUS_FAILURE:alert(trulia.errors.DEFAULT_ERROR_MESSAGE)}})}function add_friend_edit(e,t,o,n,i){var a="string"==typeof e?$("#"+e)[0]:e;if(!a)return!1;var r="string"==typeof t?$("#"+t)[0]:t;if(r){var s=6;o=o||"popup",n=n||"sp_r_email[]",i=i||s;var l=r.elements[n];if(!l)return!1;var u,c;if(l.length?(c=l[l.length-1],u=l.length):(c=l,u=1),!is_valid_email(c.value))return alert("Please enter a valid email address before adding another one."),!1;if(u>=i)return!1;++_num_friend_emails;var d="friend_email_"+_num_friend_emails,_=build_friend_edit(_num_friend_emails,d,o),p=$$("div",_,d);a.appendChild(p),$("#"+d).focus()}}function build_friend_edit(e,t,o){var n="",i='<a class="delete_link" href="javascript:remove_friend_edit(\''+t+"')\">[x]</a>";switch(o){case"details_send_property":n='<div class="input_row_label">Friend\'s email:</div><div class="input_row_input"><div class="clearfix"><div class="fleft"><input id="sp_r_email" name="sp_r_email[]" type="email" value="" /></div><div class="fleft padt5">'+i+"</div>";break;case"qa":n='<span style="float:left;width:300px"><input type="email" size="25" style="width:265px;" id="'+t+'" name="sp_r_email[]" />'+i+"</span>";break;case"clr":n='<div><input type="text" name="recipient_name['+e+']" value="Recipient\'s name" style="width: 200px;" class="client_text_box disabled_txt mart5" ',n+="onfocus=\"handle_edit_box(this,'Recipient\\'s name',true);\" onblur=\"handle_edit_box(this,'Recipient\\'s name',false);\"> ",n=n+'<input type="email" name="recipient_email['+e+']" value="Recipient\'s email" style="width: 200px; margin-left: 15px;" class="client_text_box disabled_txt mart5" ',n+="onfocus=\"handle_edit_box(this,'Recipient\\'s email',true);\" onblur=\"handle_edit_box(this,'Recipient\\'s email',false);\"> ",n=n+'<input id="recipient_schedule_cb_'+e+'" type="checkbox" checked="checked" name="recipient_schedule['+e+']" /> <label class="f11" for="recipient_schedule_cb_'+e+'"">Email weekly</label>&nbsp;&nbsp;&nbsp;<a class="delete_link tiny" href="" onclick="remove_friend_edit(\''+t+"');return false\">[x]</a></div>";break;default:n='<input type="email" value="" name="sp_r_email[]" />&nbsp;'+i}return n}function remove_friend_edit(e){var t=$("#"+e)[0];t&&t.parentNode.removeChild(t)}function postLeadSaveSuccessCallbackFunction(e,t,o,n,i,a){var r;r=function(n){i="boolean"==typeof i?i:!1,a=a||"",$.getJSON(site_root+"q_show_post_lead_success_popup.php",{property_id:e.id,property_hash:e.hash,property_status:e.status,email:a,city:e.city,state_code:e.stateCode,from_where:t,is_auto_register:o,is_post_login:n,already_saved:i,is_builder_community:e.isBuilderCommunity}).done(function(t){switch(t.status){case 1:if(destroy_popup("post_lead_success_popup"),destroy_popup("rental_community_contact_popup"),close_all_menus("contact_agent_form_popup"),t.data.popup.popup_consumer_link)t.data.popup.profile_complete?show_generic_popup("Success!","Thank you, your email has been sent to the agent"):displayPostLeadLinkToProfile(t.data.popup.header,t.data.popup.body);else{var o=new trulia.Popup({width:"380px",close:!0,classname:"post_lead_success_popup",id:"post_lead_success_popup",cache_endpoint:!1,zIndex:6006006});o.setHeader(t.data.popup.header),o.setBody(t.data.popup.body),o.show(),"For Rent"==e.status&&$(".top").hide()}"details"==trulia.page_name&&$("#post_lead_success_popup").append(createTrackingPixel()),$(document).trigger("PostLeadSuccessPopup");break;default:trulia.ContactUser.addError(trulia.errors.DEFAULT_ERROR_MESSAGE)}}).fail(function(){trulia.ContactUser.addError(trulia.errors.DEFAULT_ERROR_MESSAGE)})},"register"==n?$(document).one("loggedInDestroy.authPopup",r(!0)):r(n?!0:!1)}function createTrackingPixel(){var e=document.createElement("img"),t="http://ad.doubleclick.net/activity;dc_pixel_url=trl.bfppixel;dc_seg=106408;ord="+1e4*Math.random();return e.src=t,e.height=0,e.width=0,e.border=0,e}function displayPostLeadLinkToProfile(e,t){var o={width:"500px",close:!0,classname:"post_lead_success_popup",id:"post_lead_success_popup",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!0,isNewStyle:!0},n=new trulia.Popup(o);n.setHeader(e),n.setBody(t),$("#post_lead_go_to_profile_button").click(function(){o_track_ql_click((s&&s.pageName?s.pageName:"PostLeadForm")+"|GoToProfileButton")}),n.show()}function initOneClickCheckbox(e){var t,o,n,i;if(!e.data("initialized")){e.data("initialized",!0),e.on("click",function(){$("[data-role=one_click_checkbox]").prop("checked",e.prop("checked"))}),e.siblings(".one_click_info_hover").on("click",function(e){e.preventDefault()}),t=e.closest("[data-role=one_click_checkbox_container]"),o=_.template('<div class="typeEmphasize">What is a 1-Click Request?</div>Enable 1-Click Request to quickly send the same information to properties you contact in the future. You\'ll still have the option to view and edit the form each time.</div>'),n={anchor:"right",skin:"tooltipLight",content:o(),css:{zIndex:99999999}},i=t.find(".one_click_info_hover"),i.tooltip(n);var a=_.once(function(){o_track_ql_click(getLeadFormType(i.closest("form"))+"|1_click|info")});i.on("mouseover",a)}}function getLeadFormType(e){var t,o;return t=trulia.ContactUser.getClickTrackingMap(),e.data("open-from")?o=e.data("open-from"):trulia.photoPlayerModal&&"undefined"!=typeof trulia.photoPlayerModal.moduleName&&(o="contact_user_popup_form_photoplayer_popup"),o&&t.hasOwnProperty(o)?t[o]:"ContactForm"}function renderSpecialtyHousing(e,t){var o=e.rentalslf,n={trackState:trulia.analytics.trackState,trackAction:trulia.analytics.trackAction,saveInteractedWith:trulia.analytics.saveInteractedWith},i=!1,a=$("#"+t);if(a.length){var r=a.find("button");i=r.length?r.hasClass("btnDisabled"):i}var s=!o.isEnabled||i,l=o.contactInfo.oneClick,u={isDisabled:s,buttonText:s?"Request Sent":"Request Info",ctaUrl:o.ctaUrl,removeAttachment:!0,disableAutoSubmit:!0},c=e.React,d=e.ReactDom,_=e.Form,p=document.getElementById(e.floorplanFormData.formId);null!==p&&d.render(c.createElement(_,{propertyInfo:o.propertyInfo,contactInfo:o.contactInfo,leadData:o.leadData,eventHandlers:e.floorplanFormData.eventHandlers,trackingHandler:n,trackingContext:e.floorplanFormData.formTrackingContext,config:u,trffName:o.trffName,trffValue:o.trffValue},null),p)}define("babel-core",{}),trulia.ui.mouseTooltip={show:function(e,t){var o=$("#mouse_tooltip");o.length||(o=$(document.createElement("div")),o.attr("id","mouse_tooltip"),o.appendTo("body"),o.css({display:"none",position:"absolute",zIndex:3e4,top:0,left:0}),o.addClass("tooltip"),o.addClass("tooltip-compact")),o.html(e),$("body").mousemove(this.updatePosition)},hide:function(){$("body").unbind("mousemove",this.updatePosition),$("#mouse_tooltip").fadeOut()},updatePosition:function(e){var t=$(window).width(),o=$(window).height(),n=$("#mouse_tooltip"),i=n.width(),a=n.height(),r=e.pageY-8,s=e.pageX+12;s+i+10>t&&(s=t-i-14,r=e.pageY+a+16>o?r-a-16:r+a+8),n.css({top:r,left:s}),n.is(":visible")||n.fadeIn()}},trulia.ui.anchorToolTip=function(e,t){var o={id:e,anchorId:!1,title:"Title",body:"Body",click:!1,mouseenter:!0,mouseleave:!0,stem_offset:-15,position:"left"},n=this;o=$.extend(o,t);var i=$('<div id="'+e+'" class="tip_bubble"><div class="stem_border"></div><div class="stem"></div><div class="title">'+o.title+'</div><div class="body">'+o.body+"</div></div> "),a=$("#"+o.anchorId);"right"==o.position&&i.addClass("right"),a.after(i),o.mouseenter&&a.mouseenter(function(e){"function"==typeof o.mouseenter?o.mouseenter(n):n.show()}),o.mouseleave&&a.mouseleave(function(e){"function"==typeof o.mouseleave?o.mouseleave(n):n.hide()}),this.setContent=function(e,t){$(".title",i).html(e),$(".body",i).html(t),n.position()},this.show=function(){i.show(),n.position()},this.hide=function(){i.hide()},this.position=function(){anchorOffset=a.offset(),"left"==o.position?i.offset({top:anchorOffset.top-i.outerHeight()-6,left:anchorOffset.left+o.stem_offset}):(i.css("top",anchorOffset.top-i.outerHeight()-6+"px"),i.css("right",$(document).width()-anchorOffset.left-a.width()+"px"))}},function(e){var t=null,o=function(t){var o=e(this).data("tooltip-config");o.disabled||(o.hover_state="in",o.delay?setTimeout(function(){"in"==o.hover_state&&r(o)},o.delay):r(o))},n=function(t){var o,n,i=e(this).data("tooltip-config");i.hover_state="out",i.delay||i.delay_out?(o=i.delay_out||i.delay,n=setInterval(function(){"out"==i.hover_state&&(s(i),clearInterval(n))},o)):s(i)},i=function(o){o.tooltip.is(":visible")||t.hide(),o.hide_all_on_show&&e(".tooltip").hide()},a=function(e){var t=e.target.offset(),o=e.offset.split("x"),n,i;switch(o.length>0&&(o[0]=parseInt(o[0])),o.length>1&&(o[1]=parseInt(o[1])),e.anchor){case"right":n=e.target.width(),e.tooltip.css({position:"absolute",top:t.top-9-o[1],left:t.left+n+o[0]});break;case"left":n=e.tooltip.width(),e.tooltip.css({position:"absolute",top:t.top-9-o[1],left:t.left-n-40-o[0]});break;case"bottom":i=e.target.height(),e.tooltip.css({position:"absolute",top:t.top+i+10+o[1],left:t.left-5+o[0]});break;case"top":i=e.tooltip.height(),e.tooltip.css({position:"absolute",top:t.top-i-30-o[1],left:t.left-5+o[0]});break;case"topright":i=e.tooltip.height(),n=e.target.width(),e.tooltip.css({position:"absolute",top:t.top-i-30-o[1],left:t.left+n+o[0]})}},r=function(e){i(e),a(e),e.tooltip.fadeIn(),e.tooltip.on("mouseenter",function(){e.hover_state="in"}),e.tooltip.on("mouseleave",function(){e.tooltip.mouseout_hide&&s(e),e.hover_state="out"})},s=function(e,t){t?e.tooltip.fadeOut():e.tooltip.hide()},l={init:function(i){i=e.extend({anchor:"right",selector:!1,static_html:!1,trigger:"hover",style_classes:"tooltip",delay:200,delay_out:!1,hide_all_on_show:!1,mouseout_hide:!0,offset:"0x0"},i);var a;return 0==i.selector?(i.static_html&&(a=e('<span class="'+i.style_classes+'">'+i.static_html+"</span>")),e("body").append(a)):a=e(i.selector).addClass(i.style_classes),this.each(function(){var r=e(this).data("tooltip-config");if(!r){0!=i.selector||i.static_html||(a=e('<span class="'+i.style_classes+'">'+e(this).data("tooltip")+"</span>"),e("body").append(a)),null==t?t=e(a):t.add(a);var s={right:"left",left:"right",bottom:"top",top:"bottom",topright:"bottom"};a.addClass("tooltip-stem-"+s[i.anchor]),r={target:e(this),tooltip:a,trigger:i.trigger,delay:i.delay,delay_out:i.delay_out,hide_all_on_show:i.hide_all_on_show,anchor:i.anchor,offset:i.offset},e(this).data("tooltip-config",r),"hover"===i.trigger&&(e(this).on("mouseenter",o),e(this).on("mouseleave",n))}})},toggle:function(){return this.each(function(){var t=e(this).data("tooltip-config");t&&t.tooltip&&t.tooltip.text()&&(t.tooltip.is(":visible")?s(t):r(t))})},enable:function(){return this.each(function(){var t=e(this).data("tooltip-config");t&&t.tooltip&&t.tooltip.text()&&(t.disabled=!1,e(this).data("tooltip-config",t))})},disable:function(){return this.each(function(){var t=e(this).data("tooltip-config");t&&t.tooltip&&t.tooltip.text()&&(t.disabled=!0,e(this).data("tooltip-config",t))})},show:function(){return this.each(function(){var t=e(this).data("tooltip-config");t&&t.tooltip&&t.tooltip.text()&&r(t)})},hide:function(t){return t="boolean"==typeof t?t:!0,this.each(function(){var o=e(this).data("tooltip-config");o&&o.tooltip&&s(o,t)})},position:function(){return this.each(function(){var t=e(this).data("tooltip-config");t&&t.tooltip&&t.tooltip.text()&&a(t)})},content:function(t){return this.each(function(){var o=e(this).data("tooltip-config");o.tooltip&&o.tooltip.html(t)})}};e.fn.tooltip=function(t){return l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.tooltips"):l.init.apply(this,arguments)}}(jQuery),define("library/trulia.tooltips",function(){}),define("authentication/models/UserAuthContext",["backbone"],function(e){return e.Model.extend({defaults:{userStatus:"Home Buyer"}})}),define("authentication/models/AuthTrackingContext",["backbone"],function(e){return e.Model.extend({defaults:{flowName:"login"}})}),define("authentication/AuthEventDispatcher",["backbone","underscore"],function(e,t){return t.extend({},e.Events)}),define("omniture/omnitureTracking",[],function e(){return{authTracking:{trackEvent:function e(){window.trulia.tracking.authFlowTracking.trackEvent.apply(window.trulia.tracking.authFlowTracking,arguments)}},clickTracking:function t(){window.o_track_ql_click.apply(window,arguments)}}}),define("authentication/tracking/AuthTrackingController",["backbone","underscore","omniture/omnitureTracking"],function(e,t,o){return e.View.extend({authTrackingNamespace:"authtracking",initialize:function(e){this.authEventDispatcher=e.authEventDispatcher,this._initListeners()},_initListeners:function(){this.listenTo(this.authEventDispatcher,this.authTrackingNamespace,this._trackAuthFlow)},_trackAuthFlow:function(e){var t=e.type||"authevent";"interaction"==t?o.clickTracking(e.trackingString,null,null):o.authTracking.trackEvent(e.eventType,e.flowName,e.pageName,"|"+e.appendString)}})}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define("scriptjs",t):this[e]=t()}("$script",function(){function e(e,t){for(var o=0,n=e.length;n>o;++o)if(!t(e[o]))return s;return 1}function t(t,o){e(t,function(e){return!o(e)})}function o(i,a,r){function s(e){return e.call?e():d[e]}function u(){if(!--v){d[g]=1,m&&m();for(var o in p)e(o.split("|"),s)&&!t(p[o],s)&&(p[o]=[])}}i=i[l]?i:[i];var c=a&&a.call,m=c?a:r,g=c?i.join(""):a,v=i.length;return setTimeout(function(){t(i,function e(t,o){return null===t?u():(o||/^https?:\/\//.test(t)||!f||(t=-1===t.indexOf(".js")?f+t+".js":f+t),h[t]?(g&&(_[g]=1),2==h[t]?u():setTimeout(function(){e(t,!0)},0)):(h[t]=1,g&&(_[g]=1),void n(t,u)))})},0),o}function n(e,t){var o=i.createElement("script"),n;o.onload=o.onerror=o[c]=function(){o[u]&&!/^c|loade/.test(o[u])||n||(o.onload=o[c]=null,n=1,h[e]=2,t())},o.async=1,o.src=m?e+(-1===e.indexOf("?")?"?":"&")+m:e,a.insertBefore(o,a.lastChild)}var i=document,a=i.getElementsByTagName("head")[0],r="string",s=!1,l="push",u="readyState",c="onreadystatechange",d={},_={},p={},h={},f,m;return o.get=n,o.order=function(e,t,n){!function i(a){a=e.shift(),e.length?o(a,i):o(a,t,n)}()},o.path=function(e){f=e},o.urlArgs=function(e){m=e},o.ready=function(n,i,a){n=n[l]?n:[n];var r=[];return!t(n,function(e){d[e]||r[l](e)})&&e(n,function(e){return d[e]})?i():!function(e){p[e]=p[e]||[],p[e][l](i),a&&a(r)}(n.join("|")),o},o.done=function(e){o([null],e)},o}),define("authentication/models/FacebookConnectModel",["backbone","scriptjs"],function(e,t){var o=e.Model.extend({url:site_root+"_ajax/User/Users/login_by_facebook/",initialize:function(e){this.facebookOptions=e,this._initializeSdk()},login:function(){var e=$.Deferred(),t=this;return this._initializeSdk().then(function(o){t._doFacebookLogin(o,e)}),e.promise()},_initializeSdk:function(){var e=this,n=$.Deferred();return o._initialized?n.resolve(window.FB):t("//connect.facebook.net/en_US/sdk.js",function(){window.FB.init({appId:e.facebookOptions.facebookAppId,cookie:!0,xfbml:!0,oauth:!0,version:"v2.5"}),o._initialized=!0,n.resolve(window.FB)}),n.promise()},_doFacebookLogin:function(e,t){var o=this;e.login(function(e){return e.status&&e.authResponse?e.authResponse&&e.authResponse.accessToken?void o._loginTruliaUser(e.authResponse.accessToken,t):(o_track_fb_activity_click("FreePass|FBConnect_ErrorNoPerms"),void t.reject()):(o_track_fb_activity_click("FreePass|FBConnect_ErrorNoSession"),void t.reject())},{scope:o.facebookOptions.scope})},_loginTruliaUser:function(e,t){this.save({access_token:e}).then(function(e,o,n){o_track_fb_activity_click("FreePass|FBConnect_Success"),t.resolve(e,n)}).fail(function(){o_track_fb_activity_click("FreePass|FBConnect_ErrorConnect"),t.reject()})}});return o._initialized=!1,o}),define("es6",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("es6!authentication/tracking/LoginAnalyticsTracking",["exports","module"],function(e,t){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(){function e(){o(this,e),this.truliaFormErrorText="error|trulia connection failed",this.userLoginStatusLoggedIn="logged in",this.userLoginStatusLoggedOut="logged out",this._initializeTrackingData()}return n(e,[{key:"_initializeTrackingData",value:function t(){this.trackingData={siteSection:"account",pageType:"sign in",pageDetails:"enter email",form:"reg:free pass",registrationEnd:"",loginStart:"",loginEnd:"",interactedWith:"",truliaUserID:"",userLoginStatus:this.userLoginStatusLoggedOut,formError:"",formErrorDisplayed:""}}},{key:"_triggerAnalyticsTrackAction",value:function i(){window.trulia.analytics.trackAction(this.trackingData)}},{key:"_setLoginStartData",value:function a(e){this.trackingData.loginStart=""||e}},{key:"_setLoginEndData",value:function r(e){this.trackingData.loginEnd=""||e}},{key:"_setRegistrationData",value:function s(e){this.trackingData.registrationEnd=""||e}},{key:"_setInteractedWithData",value:function l(e){this.trackingData.interactedWith=e}},{key:"_setTruliaUserId",value:function u(e){var t=""||e;this.trackingData.truliaUserID=t,""!==t&&(this.trackingData.userLoginStatus=this.userLoginStatusLoggedIn)}},{key:"_setFormErrorText",value:function c(e){this.trackingData.formError=e,this.trackingData.formErrorDisplayed="1"}}]),e}();t.exports=i}),define("es6!authentication/tracking/GoogleAnalyticsTracking",["exports","module","es6!authentication/tracking/LoginAnalyticsTracking"],function(e,t,o){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)
}var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=function c(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o;s=u=l=void 0,n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var l=s.get;return void 0===l?void 0:l.call(r)}var u=Object.getPrototypeOf(i);if(null===u)return void 0;e=u,t=a,o=r,n=!0}},l=n(o),u=function(e){function t(){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.googleFormErrorText="error|google connection failed",this.interactedWithGoogleText="sign in modal:google link"}return a(t,e),r(t,[{key:"triggerGoogleAnalyticsDoLogin",value:function o(){this._initializeTrackingData(),this._setInteractedWithData(this.interactedWithGoogleText),this._setLoginStartData("1"),this._triggerAnalyticsTrackAction()}},{key:"triggerGoogleAnalyticsLoginSuccess",value:function n(e,t){this._initializeTrackingData(),this._setInteractedWithData(this.interactedWithGoogleText),this._setTruliaUserId(e),this._setLoginEndData("1"),this._setRegistrationData(t),this._triggerAnalyticsTrackAction()}},{key:"triggerGoogleAnalyticsLoginError",value:function l(e){this._initializeTrackingData(),this._setInteractedWithData(this.interactedWithGoogleText),this._setFormErrorText(e?this.googleFormErrorText:this.truliaFormErrorText),this._triggerAnalyticsTrackAction()}}]),t}(l["default"]);t.exports=u}),define("authentication/models/GoogleSignInModel",["backbone","scriptjs","es6!authentication/tracking/GoogleAnalyticsTracking"],function(e,t,o){var n,i="https://apis.google.com/js/client:platform.js?onload=start",a=new o,r=e.Model.extend({url:site_root+"_ajax/User/Users/login_by_google/",initialize:function(e,t){this.clientId=t},login:function(){var e=$.Deferred(),t=this;return this._initializeGoogleManager().then(function(o){o.signIn().then(function(o){return o.getAuthResponse()&&o.getAuthResponse().id_token?void t._loginTruliaUser(o.getAuthResponse().id_token,e):(a.triggerGoogleAnalyticsLoginError(!0),void e.reject())},function(){a.triggerGoogleAnalyticsLoginError(!0),e.reject()})}),e.promise()},_initializeGoogleManager:function(){var e=$.Deferred();return window.gapi?e.resolve(n):t(i,this._loadGoogleAuth.bind(this,e)),e.promise()},_loadGoogleAuth:function(e){var t=this;gapi.load("auth2",function(){gapi.auth2.init({client_id:t.clientId,scope:"profile email",response_type:"id_token permission"}).then(function(t){e.resolve(t),n=t})})},_loginTruliaUser:function(e,t){this.save({id_token:e}).then(function(e,o,n){t.resolve(e,n)}).fail(function(){a.triggerGoogleAnalyticsLoginError(!1),t.reject()})}});return r}),define("es6!application/captcha/CaptchaPlacement",["exports","module"],function(e,t){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(){function e(t){o(this,e),this.domElement=t,this.id=t.id,this.widgetId=void 0}return n(e,[{key:"isRendered",value:function t(){return"undefined"!=typeof this.widgetId&&document.body.contains(this.domElement)}}]),e}();t.exports=i}),define("es6!application/captcha/captcha",["exports","module","scriptjs","es6!./CaptchaPlacement"],function(e,t,o,n){function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){return e&&e.isRendered()||(e=new p["default"](t)),e}function s(){return"undefined"!=typeof window.grecaptcha}function l(e,t){e.isRendered()?window.grecaptcha.reset(e.widgetId):e.widgetId=window.grecaptcha.render(e.domElement,{sitekey:t})}function u(e,t,o){window.onCaptchaLibraryLoaded=window.onCaptchaLibraryLoaded||function(){c(o,t)},_["default"](e)}function c(e,t){for(var o=void 0;o=e.pop();)l(o,t)}var d=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_=i(o),p=i(n),h=function(){function e(t){a(this,e),this.apiUrl="//www.google.com/recaptcha/api.js?onload=onCaptchaLibraryLoaded&render=explicit",this.apiKey=t,this.captchas={},this.queuedCaptchas=[]}return d(e,[{key:"render",value:function t(e){var t=e.id;this.captchas[t]=r(this.captchas[t],e),s()?l(this.captchas[t],this.apiKey):(this.queuedCaptchas.push(this.captchas[t]),u(this.apiUrl,this.apiKey,this.queuedCaptchas))}},{key:"getValueById",value:function o(e){var t=null;return window.grecaptcha&&this.captchas[e]&&this.captchas[e].isRendered()&&(t=window.grecaptcha.getResponse(this.captchas[e].widgetId)),t}}]),e}();t.exports=h}),define("text",["module"],function(e){var t,o,n,i,a,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),d=u&&location.hostname,_=u&&(location.port||void 0),p={},h=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,o;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){o=r[t];try{e=new ActiveXObject(o)}catch(n){}if(e){r=[o];break}}return e},parseName:function(e){var t,o,n,i=!1,a=e.indexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!r||a>1)?(t=e.substring(0,a),o=e.substring(a+1,e.length)):t=e,n=o||t,a=n.indexOf("!"),-1!==a&&(i="strip"===n.substring(a+1),n=n.substring(0,a),o?o=n:t=n),{moduleName:t,ext:o,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,o,n,i){var a,r,s,l=t.xdRegExp.exec(e);return l?(a=l[2],r=l[3],r=r.split(":"),s=r[1],r=r[0],!(a&&a!==o||r&&r.toLowerCase()!==n.toLowerCase()||(s||r)&&s!==i)):!0},finishLoad:function(e,o,n,i){n=o?t.strip(n):n,h.isBuild&&(p[e]=n),i(n)},load:function(e,o,n,i){if(i.isBuild&&!i.inlineText)return void n();h.isBuild=i.isBuild;var a=t.parseName(e),r=a.moduleName+(a.ext?"."+a.ext:""),s=o.toUrl(r),l=h.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void n():void(!u||l(s,c,d,_)?t.get(s,function(o){t.finishLoad(e,a.strip,o,n)},function(e){n.error&&n.error(e)}):o([r],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,n)}))},write:function(e,o,n,i){if(p.hasOwnProperty(o)){var a=t.jsEscape(p[o]);n.asModule(e+"!"+o,"define(function () { return '"+a+"';});\n")}},writeFile:function(e,o,n,i,a){var r=t.parseName(o),s=r.ext?"."+r.ext:"",l=r.moduleName+s,u=n.toUrl(r.moduleName+s)+".js";t.load(l,n,function(o){var n=function(e){return i(u,e)};n.asModule=function(e,t){return i.asModule(e,u,t)},t.write(e,l,n,a)},a)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(o=require.nodeRequire("fs"),t.get=function(e,t,n){try{var i=o.readFileSync(e,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),t(i)}catch(a){n(a)}}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,o,n,i){var a=t.createXhr(),r;if(a.open("GET",e,!0),i)for(r in i)i.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),i[r]);h.onXhr&&h.onXhr(a,e),a.onreadystatechange=function(t){var i,r;4===a.readyState&&(i=a.status,i>399&&600>i?(r=new Error(e+" HTTP status: "+i),r.xhr=a,n(r)):o(a.responseText),h.onXhrComplete&&h.onXhrComplete(a,e))},a.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var o,n,i="utf-8",a=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),i)),l="";try{for(o=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&o.append(n);null!==(n=s.readLine());)o.append(r),o.append(n);l=String(o.toString())}finally{s.close()}t(l)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var o,r,s,l={};a&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{o=n["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),o.init(s,1,0,!1),r=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),r.init(o,"utf-8",o.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(o.available(),l),r.close(),o.close(),t(l.value)}catch(u){throw new Error((s&&s.path||"")+": "+u)}}),t}),define("tpl",["text","underscore"],function(e,t){var o={},n="define('{pluginName}!{moduleName}', function () { return {source}; });\n";return{version:"0.0.2",load:function(n,i,a,r){if(o[n])a(o[n]);else{var s=r.tpl&&r.tpl.extension||".html",l=r.tpl&&r.tpl.path||"";e.load(l+n+s,i,function(e){o[n]=t.template(e),a(o[n])},r)}},write:function(e,t,i){var a=o[t],r=a&&a.source;r&&i.asModule(e+"!"+t,n.replace("{pluginName}",e).replace("{moduleName}",t).replace("{source}",r))}}}),define("tpl!authentication/templates/registerForm",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<form data-role="email_login" class="form phm" name="email_login_form" method="POST">\n  <div class="cols19 centerHorizontal">\n    <div class="mbs txtC h3 typeEmphasize">\n      '+(null==(__t=header)?"":__t)+'\n    </div>\n    <div class="mbl txtC h5">\n      '+(null==(__t=subheader)?"":__t)+'\n    </div>\n    <div class="centerHorizontal">\n      <div class="field mtn">\n        <div class="fieldItem text pbm">\n          <input data-role="login_email_input" size="25" type="text" name="email" value="" placeholder="Enter email address">\n          <small data-role="error_message" class="typeWarning"></small>\n        </div>\n      </div>\n      <div id=\'regReCaptchaWrapper\' class="centerHorizontal"></div>\n      <div class="field">\n        <button data-action="submit" class="btn btnPrimary btnFullWidth">Submit</button>\n      </div>\n\n      <div data-role="facebookLogin" class="txtC"></div>\n\n      <div data-role="googleSignIn" class="txtC"></div>\n\n      <p class="txtC h8 typeLowlight pvm">\n        I accept Trulia&apos;s <a class="linkLowlight" href="'+(null==(__t=site_root)?"":__t)+'terms/" target="_blank">Terms of Use</a> and <a class="linkLowlight" href="'+(null==(__t=site_root)?"":__t)+'privacy/" target="_blank">Privacy Policy</a>.\n      </p>\n\n      ',agent_signup_cta&&(__p+='\n        <p class="txtC btnLink h7">\n          <a href="'+(null==(__t=site_root)?"":__t)+"agent_signup/?redirect_url="+(null==(__t=agent_signup_redirect_url)?"":__t)+'">'+(null==(__t=agent_signup_cta)?"":__t)+"</a>\n        </p>\n      "),__p+="\n    </div>\n  </div>\n</form>\n";return __p}}),define("tpl!authentication/templates/facebookConnect",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="line mtl">\n  <div class="col cols11">\n    <hr>\n  </div>\n  <div class="col cols2 typeLowlight centerVertical">\n    OR\n  </div>\n  <div class="col cols11">\n    <hr>\n  </div>\n</div>\n<div class="field">\n    <button name="fbSignIn" class="btn btnFacebook btnFullWidth"><i class="iconFacebook"></i>Continue with Facebook</button>\n</div>';return __p}}),define("tpl!authentication/templates/googleSignIn",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="line mts">\n</div>\n<div class="field">\n  <button name="googleSignIn" class="btn btnDefault btnFullWidth"><i class="iconGoogleSignIn"></i>Continue with Google</button>\n</div>\n';return __p}}),define("authentication/views/RegisterFormView",["backbone","globals","es6!authentication/tracking/GoogleAnalyticsTracking","es6!application/captcha/captcha","tpl!authentication/templates/registerForm","tpl!authentication/templates/facebookConnect","tpl!authentication/templates/googleSignIn"],function(e,t,o,n,i,a,r){var s=new o;return e.View.extend({IS_EXISTING_USER:204,IS_NEW_USER:201,ERR_TOO_MANY_REQUESTS:429,ERR_INVALID_LOGIN:400,REGISTRATION_END_TRUE:"1",REGISTRATION_END_FALSE:"",events:{'click [data-action="submit"]':"_submitHandler",'focus [data-role="login_email_input"]':"_inputFocusHandler",'click [name="fbSignIn"]':"_facebookLogin",'click [name="googleSignIn"]':"_googleSignIn"},initialize:function(e){this.authModalContent=e.authModalContent,this.authStateModel=e.authStateModel,this.userModel=e.userModel,this.authEventDispatcher=e.authEventDispatcher,this.authTrackingContext=e.authTrackingContext,this.facebookConnectModel=e.facebookConnectModel,this.googleSignInModel=e.googleSignInModel,this.captcha=new n(t.recaptchaKey),this._initListeners()},render:function(){var e=_.extend(this.authModalContent.toJSON(),{site_root:site_root}),t=this.userModel.get("email");return this.setElement(i(e)),this.$emailField=this.$("[data-role=login_email_input]"),this.$errorMessage=this.$('[data-role="error_message"]'),this.$submitBtn=this.$('[data-action="submit"]'),this.$facebookButton=this.$('[data-role="facebookLogin"]'),this.$googleButton=this.$('[data-role="googleSignIn"]'),this.$regRecaptchaWrapper=this.$("#regReCaptchaWrapper"),t&&this.$emailField.val(t),this.$facebookButton.html(a()),this.$googleButton.html(r()),this._triggerClickTracking("impression"),this.$el},_initListeners:function(){this.listenTo(this.userModel,"sync",this._successCallback),this.listenTo(this.userModel,"error",this._failCallback),this.listenTo(this.userModel,"invalid",this._invalidModelHandler),this.listenTo(this.userModel,"change:isLoading",this._isLoadingChangeHandler),this.listenTo(this.userModel,"request",this._requestHandler)},_submitHandler:function(){var e=this._getSanitizedEmail(this.$emailField.val()),t=this.userModel.set("email",e,{validate:!0});return this.userModel.set("captchaResponse",this._getCaptchaResponse()),t&&(this.userModel.save(),this._triggerClickTracking("submit")),!1},_getCaptchaResponse:function(){return this.captcha.getValueById(this.$regRecaptchaWrapper.attr("id"))},_facebookLogin:function(e){var t=this;e.preventDefault(),this.$facebookButton.html('<i class="iconSpinner"></i>'),this.facebookConnectModel.login().then(function(e,o){o.status===t.IS_NEW_USER&&(t.userModel.set("isNewRegistration",!0),t._triggerAuthEventTracking("register_success","Facebook")),t.userModel.set(e),t.authStateModel.setLoginCompleteState()}).fail(function(){t.$facebookButton.html(a())})},_googleSignIn:function(e){var t=this;e.preventDefault(),this.$googleButton.html('<i class="iconSpinner"></i>'),s.triggerGoogleAnalyticsDoLogin(),this.googleSignInModel.login().then(function(e,o){o.status===t.IS_NEW_USER?(t.userModel.set("isNewRegistration",!0),s.triggerGoogleAnalyticsLoginSuccess(e.userId,t.REGISTRATION_END_TRUE)):(t.userModel.set("isNewRegistration",!1),s.triggerGoogleAnalyticsLoginSuccess(e.userId,t.REGISTRATION_END_FALSE)),t.userModel.set(e),t.authStateModel.setLoginCompleteState()}).fail(function(){t.$googleButton.html(r())})},_successCallback:function(e,t,o){switch(this.userModel.set("isLoading",!1),o.xhr.status){case this.IS_EXISTING_USER:this.authStateModel.setLoginState();break;case this.IS_NEW_USER:this._triggerAuthEventTracking("register_success","free_pass"),this.userModel.set("isNewRegistration",!0),this.authStateModel.setPasswordUpdateState()}},_failCallback:function(e,t,o){var n,i=this;switch(this.userModel.set("isLoading",!1),o.xhr.status){case this.ERR_TOO_MANY_REQUESTS:return void this.captcha.render(this.$regRecaptchaWrapper[0]);default:case this.ERR_INVALID_LOGIN:n="Please try again"}this.$errorMessage.html(n)},_inputFocusHandler:function(){this.$errorMessage.empty()},_requestHandler:function(){this.userModel.set("isLoading",!0)},_invalidModelHandler:function(e,t){this.$errorMessage.html(t)},_isLoadingChangeHandler:function(){var e=this.userModel.get("isLoading");this.$submitBtn.attr("disabled",e)},_getSanitizedEmail:function(e){return $.trim(e).toLowerCase()},_triggerAuthEventTracking:function(e,t){this._triggerTracking({type:"authevent",eventType:e,flowName:this.authTrackingContext.get("flowName"),pageName:null,appendString:t})},_triggerClickTracking:function(e){this._triggerTracking({type:"interaction",trackingString:"free_pass|sign_in_or_register|"+e})},_triggerTracking:function(e){this.authEventDispatcher.trigger("authtracking",e)}})}),define("tpl!authentication/templates/loginForm",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<form data-role="password_login" class="form phm" name="password_login_form">\n  <div class="cols19 centerHorizontal">\n    <div class="txtC h3 typeEmphasize">\n      <p class="mbl mtn">'+(null==(__t=login_header)?"":__t)+'</p>\n    </div>\n    <p data-role="welcome_subheader" class="txtC">'+(null==(__t=subHeader)?"":__t)+'</p>\n    <div class="centerHorizontal pbl">\n      <div class="field mtn">\n        <div class="fieldItem text pbm">\n          <input data-role="login_password_field" size="25" type="password" name="password" value="" placeholder="Enter password">\n          <small data-role="error_message" class="typeWarning"></small>\n        </div>\n      </div>\n      <div id=\'loginReCaptchaWrapper\' class="centerHorizontal"></div>\n      <div class="field">\n        <button data-action="submit" class="btn btnPrimary btnFullWidth">Sign In</button>\n      </div>\n    </div>\n  </div>\n</form>\n<div class="bts txtC ptl">\n  <a href="#" data-role="password_reset">Forgot your password?</a>\n</div>\n';return __p}}),define("authentication/views/LoginFormView",["backbone","globals","es6!application/captcha/captcha","tpl!authentication/templates/loginForm"],function(e,t,o,n){const i=400,a=401,r=429;return e.View.extend({events:{'click [data-role="password_reset"]':"_passwordReset",'click [data-action="submit"]':"_submitHandler",'focus [data-role="login_password_field"]':"_inputFocusHandler"},initialize:function(e){this.userModel=e.userModel,this.authStateModel=e.authStateModel,this.authEventDispatcher=e.authEventDispatcher,this.authTrackingContext=e.authTrackingContext,this.authModalContent=e.authModalContent,this.captcha=new o(t.recaptchaKey),this._initListeners()},render:function(){var e="";return this.authStateModel.getCurrentAuthState()===this.authStateModel.getPasswordResetCompleteState()&&(e="Email sent - check your inbox for your new password."),this.setElement(n(_.extend(this.authModalContent.toJSON(),{subHeader:e}))),this.$loginPasswordField=this.$('[data-role="login_password_field"]'),this.$errorMessage=this.$('[data-role="error_message"]'),this.$signInBtn=this.$('[data-action="submit"]'),this.$captchaContainer=this.$("#loginReCaptchaWrapper"),this._triggerClickTracking("impression"),this.$el},_initListeners:function(){this.listenTo(this.userModel,"request",this._requestHandler),this.listenTo(this.userModel,"sync",this._modelSyncHandler),this.listenTo(this.userModel,"error",this._modelErrorHandler),this.listenTo(this.userModel,"change:isLoading",this._isLoadingChangeHandler),this.listenTo(this.userModel,"invalid",this._invalidModelHandler)},_passwordReset:function(e){e.preventDefault(),this._triggerClickTracking("forgot_password"),this.authStateModel.setPasswordResetState()},_requestHandler:function(){this.userModel.set("isLoading",!0)},_isLoadingChangeHandler:function(){var e=this.userModel.get("isLoading");this.$signInBtn.attr("disabled",e)},_submitHandler:function(e){return this._triggerAuthEventTracking("login_attempt"),this.userModel.login({p:this.$loginPasswordField.val(),captchaResponse:this.captcha.getValueById(this.$captchaContainer.attr("id"))},{validate:!0}),!1},_modelSyncHandler:function(e,t,o){switch(this.userModel.set("isLoading",!1),o.xhr.status){case 200:this._triggerClickTracking("sign_in"),this._triggerAuthEventTracking("login_success")}this.authStateModel.setLoginCompleteState()},_modelErrorHandler:function(e,t,o){switch(this.userModel.set("isLoading",!1),o.xhr.status){case i:this.$errorMessage.html("Missing email or password. Please try again.");break;case a:this.$errorMessage.html("Wrong password. Please try again.");break;case r:this.captcha.render(this.$captchaContainer[0])}},_inputFocusHandler:function(){this.$errorMessage.empty()},_invalidModelHandler:function(e,t){this.$errorMessage.html(t)},_triggerAuthEventTracking:function(e){this._triggerTracking({type:"authevent",eventType:e,flowName:this.authTrackingContext.get("flowName"),pageName:null,appendString:"free_pass"})},_triggerClickTracking:function(e){this._triggerTracking({type:"interaction",trackingString:"free_pass|welcome_back|"+e})},_triggerTracking:function(e){this.authEventDispatcher.trigger("authtracking",e)}})}),define("tpl!authentication/templates/passwordResetForm",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<form data-role="password_reset" class="form phm" name="password_reset_form">\n  <div class="cols19 centerHorizontal">\n    <div class="mbm txtC h3 typeEmphasize">\n      Forgot your password?\n    </div>\n    <p class="txtC">Enter your email address and we&apos;ll email you a new password.</p>\n    <div class="centerHorizontal pbl">\n      <div class="field mtn">\n        <div class="fieldItem text pbm">\n          <input data-role="reset_email_input" size="25" type="text" name="reset_email_input" value="" placeholder="Enter email">\n          <small data-role="error_message" class="typeWarning"></small>\n        </div>\n      </div>\n      <div class="field">\n        <button data-action="submit" class="btn btnPrimary btnFullWidth">Submit</button>\n      </div>\n    </div>\n  </div>\n</form>\n<div class="bts txtC ptl">\n  <div>Remember your password? <a href="#" data-role="toggle_login">Sign in.</a></div>\n</div>\n';return __p}}),define("authentication/views/PasswordResetFormView",["backbone","tpl!authentication/templates/passwordResetForm"],function(e,t){return e.View.extend({events:{'click [data-action="submit"]':"_resetPassword",'focus [data-role="email_input"]':"_inputFocusHandler",'click [data-role="toggle_login"]':"_toggleLogin"},initialize:function(e){this.authStateModel=e.authStateModel,this.userModel=e.userModel,this.authEventDispatcher=e.authEventDispatcher,this.HTTP_STATUS_NO_CONTENT=204,this._initListeners()},render:function(){return this.setElement(t()),this.$emailInput=this.$el.find('[data-role="reset_email_input"]'),this.$errorMessage=this.$('[data-role="error_message"]'),this.$submitBtn=this.$('[data-action="submit"]'),this._setEmailInput(),this._triggerClickTracking("impression"),this.$el},_initListeners:function(){this.listenTo(this.userModel,"request",this._requestHandler),this.listenTo(this.userModel,"change:isLoading",this._isLoadingChangeHandler),this.listenTo(this.userModel,"sync",this._successHandler),this.listenTo(this.userModel,"invalid",this._invalidHandler)},_resetPassword:function(e){e.preventDefault(),this.userModel.resetPassword({email:this._getSanitizedEmail(this.$emailInput.val())},{validate:!0})},_inputFocusHandler:function(){this.$errorMessage.empty()},_requestHandler:function(){this.userModel.set("isLoading",!0)},_isLoadingChangeHandler:function(){var e=this.userModel.get("isLoading");this.$submitBtn.attr("disabled",e)},_successHandler:function(e,t,o){this.userModel.set("isLoading",!1),o.xhr.status==this.HTTP_STATUS_NO_CONTENT&&(this._triggerClickTracking("submit"),this.authStateModel.setPasswordResetCompleteState())},_invalidHandler:function(e,t){this.$errorMessage.html(t)},_toggleLogin:function(e){e.preventDefault(),this._triggerClickTracking("sign_in"),this.authStateModel.setLoginState()},_getSanitizedEmail:function(e){return $.trim(e).toLowerCase()},_setEmailInput:function(){this.userModel.get("email")&&this.$emailInput.val(this.userModel.get("email"))},_triggerClickTracking:function(e){this._triggerTracking({type:"interaction",trackingString:"free_pass|forgot_password|"+e})},_triggerTracking:function(e){this.authEventDispatcher.trigger("authtracking",e)}})}),define("tpl!authentication/templates/passwordUpdateForm",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<form data-role="password_register" class="form phm" name="password_register_form">\n  <div class="cols19 centerHorizontal">\n    <div class="mbl txtC h3 typeEmphasize">\n      <div>'+(null==(__t=create_password_header)?"":__t)+'</div>\n    </div>\n    <div class="centerHorizontal pbl">\n      <div class="field mtn">\n        <div class="fieldItem text pbm">\n          <input data-role="register_password_input" size="25" type="password" name="password" value="" placeholder="Enter password, '+(null==(__t=window._MIN_PASSWORD_LENGTH)?"":__t)+"-"+(null==(__t=window._MAX_PASSWORD_LENGTH)?"":__t)+' characters">\n          <small data-role="error_message" class="typeWarning"></small>\n        </div>\n      </div>\n      <div class="field">\n        <button data-action="submit" class="btn btnPrimary btnFullWidth">Save Password</button>\n      </div>\n    </div>\n  </div>\n</form>\n<div class="bts txtC ptl">\n  <a href="#" data-role="password_reset">Do this later</a>\n</div>\n';return __p}}),define("authentication/views/PasswordUpdateFormView",["backbone","tpl!authentication/templates/passwordUpdateForm"],function(e,t){return e.View.extend({loadingText:"Processing...",events:{'click [data-action="submit"]':"_updatePassword","click [data-role=password_reset]":"_resetPassword",'focus [data-role="register_password_input"]':"_inputFocusHandler"},initialize:function(e){this.authModalContent=e.authModalContent,this.authStateModel=e.authStateModel,this.userModel=e.userModel,this.authEventDispatcher=e.authEventDispatcher,this._initListeners()},_initListeners:function(){this.listenTo(this.userModel,"request",this._requestHandler),this.listenTo(this.userModel,"change:isLoading",this._isLoadingChangeHandler),this.listenTo(this.userModel,"invalid",this._invalidHandler),this.listenTo(this.authEventDispatcher,"postCloseModal",this._postCloseHandler)},_requestHandler:function(){this.userModel.set("isLoading",!0)},_isLoadingChangeHandler:function(){var e=this.userModel.get("isLoading");this.$submitBtn.attr("disabled",e)},render:function(){return this.setElement(t(this.authModalContent.toJSON())),this.$passwordInput=this.$el.find('[data-role="register_password_input"]'),this.$resetPasswordLink=this.$el.find('[data-role="password_reset"]'),this.$errorMessage=this.$('[data-role="error_message"]'),this.$submitBtn=this.$('[data-action="submit"]'),this._triggerClickTracking("impression"),this.$el},_updatePassword:function(){var e=this.userModel.set("p",this._getSanitizedPassword(),{validate:!0});return e&&(this.userModel.save().then(this._successHandler.bind(this)),this._triggerClickTracking("submit")),!1},_resetPassword:function(e){var t=this.userModel.get("isLoading");t||(e&&(e.preventDefault(),this.$resetPasswordLink.text(this.loadingText).addClass("activeLink")),this.userModel.resetPassword({email:this.userModel.get("email")},{validate:!0,type:"post"}).then(this._successHandler.bind(this)),this._triggerClickTracking("do_later"))},_inputFocusHandler:function(){this.$errorMessage.empty()},_successHandler:function(e,t,o){switch(this.userModel.set("isLoading",!1),o.status){case 204:case 205:this.authStateModel.setPasswordUpdateCompleteState();break;case 400:}},_invalidHandler:function(e,t){this.$errorMessage.html(t)},_getSanitizedPassword:function(){return $.trim(this.$passwordInput.val())},_postCloseHandler:function(){this.authStateModel.getCurrentAuthState()!==this.authStateModel.getPasswordUpdateCompleteState()&&this._resetPassword()},_triggerClickTracking:function(e){this._triggerTracking({type:"interaction",trackingString:"free_pass|choose_password|"+e})},_triggerTracking:function(e){this.authEventDispatcher.trigger("authtracking",e)}})}),define("authentication/views/AutoRegisterFacade",["backbone"],function(e){return e.View.extend({IS_EXISTING_USER:204,IS_NEW_USER:201,initialize:function(e){this.authStateModel=e.authStateModel,this.userModel=e.userModel,this.authEventDispatcher=e.authEventDispatcher,this.authTrackingContext=e.authTrackingContext,this._initListeners()},_initListeners:function(){this.listenTo(this.userModel,"sync",this._setAuthState)},_setAuthState:function(e,t,o){switch(this.userModel.set("isLoading",!1),o.xhr.status){case this.IS_EXISTING_USER:this.authStateModel.setLoginState();break;case this.IS_NEW_USER:this._triggerAuthEventTracking("register_success"),this.userModel.set("isNewRegistration",!0),this.authStateModel.setPasswordUpdateState()}},register:function(e){var t=$.Deferred(),o=this.userModel.set("email",e,{validate:!0});return o?t=this.userModel.save():t.resolve(),t},_triggerAuthEventTracking:function(e){this.authEventDispatcher.trigger("authtracking",{type:"authevent",eventType:e,flowName:this.authTrackingContext.get("flowName"),pageName:null,appendString:"free_pass"})}})}),define("authentication/AuthController",["backbone","globals","authentication/models/FacebookConnectModel","authentication/models/GoogleSignInModel","authentication/views/RegisterFormView","authentication/views/LoginFormView","authentication/views/PasswordResetFormView","authentication/views/PasswordUpdateFormView","authentication/views/AutoRegisterFacade"],function(e,t,o,n,i,a,r,s,l){return e.View.extend({initialize:function(e){this.authModalContent=e.authModalContent,this.userModel=e.userModel,this.authStateModel=e.authStateModel,this.AuthModalView=e.authModalView,this.authEventDispatcher=e.authEventDispatcher,this.userAuthContext=e.userAuthContext,this._deferred=e.deferred,this.facebookConnectModel=new o({facebookAppId:_fb_app_id,scope:_fb_permissions}),this.googleSignInModel=new n({account_source:qpn_NAMES.account_source},window._google_client_id),this._initListeners()},login:function(){return this.render(),this._deferred.promise()},render:function(){this.AuthModalView.openModal(),this._handleAuthState()},autoRegister:function(e){var t=this,o=new l({authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher,authTrackingContext:this.authTrackingContext});return o.register(e).done(function(){t.login()}),this._deferred.promise()},autoRegisterWithoutPassword:function(e){var t=this,o=new l({authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher,authTrackingContext:this.authTrackingContext});return o.register(e).then(function(e,o,n){t.AuthModalView.closeModal(),201===n.status&&t._fireLegacyEvents(),t._deferred.resolve(t.userModel)}),this._deferred.promise()},autoLogin:function(){this._fireLegacyEvents()},setUserAuthContext:function(e){this.userModel.set(e.toJSON())},setAuthTrackingContext:function(e){this.authTrackingContext=e},_initListeners:function(){this.listenTo(this.authStateModel,"change:authState",this._handleAuthState),this.listenTo(this.authEventDispatcher,"postCloseModal",this._handleAuthModalClosed)
},_handleAuthState:function(){var e=this.authStateModel.getCurrentAuthState();switch(e){case this.authStateModel.getLoginState():this._setLoginFormView();break;case this.authStateModel.getPasswordUpdateState():this._setPasswordUpdateFormView();break;case this.authStateModel.getPasswordResetState():this._setPasswordResetFormView();break;case this.authStateModel.getLoginCompleteState():case this.authStateModel.getPasswordUpdateCompleteState():this._handleSuccessfulLogin();break;case this.authStateModel.getPasswordResetCompleteState():this._setLoginFormView();break;default:this._setRegisterFormView()}},_handleSuccessfulLogin:function(){this.AuthModalView.closeModal(),this._fireLegacyEvents(),this._deferred.resolve(this.userModel)},_fireLegacyEvents:function(){t.isUserLoggedIn=!0,window._trulia_logged_in=1,$(document).trigger("loggedIn.auth"),$(document).trigger("loggedInDestroy.authPopup",["freepass"]);var e=document.createEvent("Event");e.initEvent("trulia.userLoggedIn",!0,!0),document.dispatchEvent(e)},_setRegisterFormView:function(){this.AuthModalView.setView(new i({authModalContent:this.authModalContent,authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher,authTrackingContext:this.authTrackingContext,facebookConnectModel:this.facebookConnectModel,googleSignInModel:this.googleSignInModel}))},_setLoginFormView:function(){this.AuthModalView.setView(new a({authModalContent:this.authModalContent,authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher,authTrackingContext:this.authTrackingContext}))},_setPasswordUpdateFormView:function(){this.AuthModalView.setView(new s({authModalContent:this.authModalContent,authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher}))},_setPasswordResetFormView:function(){this.AuthModalView.setView(new r({authStateModel:this.authStateModel,userModel:this.userModel,authEventDispatcher:this.authEventDispatcher}))},_handleAuthModalClosed:function(){this.isAuthFlowCompleted()||(this.authStateModel.setRegisterState(),this._setRegisterFormView(),this.authModalContent.clear(),this.authModalContent.set(this.authModalContent.defaults),this._deferred.reject())},isAuthFlowCompleted:function(){return this.authStateModel.isPasswordUpdateState()||this.authStateModel.isLoginCompleteState()||this.authStateModel.isPasswordUpdateCompleteState()},logout:function(){window._trulia_logged_in=t.isUserLoggedIn=!1,delete this.userModel.id}})}),define("authentication/models/AuthStateModel",["backbone"],function(e){return e.Model.extend({defaults:{authState:"register"},getCurrentAuthState:function(){return this.get("authState")},getRegisterState:function(){return"register"},getLoginState:function(){return"login"},getLoginCompleteState:function(){return"loginComplete"},getPasswordUpdateState:function(){return"passwordUpdate"},getPasswordUpdateCompleteState:function(){return"passwordUpdateComplete"},getPasswordResetState:function(){return"passwordReset"},getPasswordResetCompleteState:function(){return"passwordResetComplete"},setRegisterState:function(){this.set("authState",this.getRegisterState())},setLoginState:function(){this.set("authState",this.getLoginState())},setLoginCompleteState:function(){this.set("authState",this.getLoginCompleteState())},setPasswordUpdateState:function(){this.set("authState",this.getPasswordUpdateState())},setPasswordUpdateCompleteState:function(){this.set("authState",this.getPasswordUpdateCompleteState())},setPasswordResetState:function(){this.set("authState",this.getPasswordResetState())},setPasswordResetCompleteState:function(){this.set("authState",this.getPasswordResetCompleteState())},isPasswordUpdateState:function(){return this.getCurrentAuthState()===this.getPasswordUpdateState()},isPasswordUpdateCompleteState:function(){return this.getCurrentAuthState()===this.getPasswordUpdateCompleteState()},isLoginCompleteState:function(){return this.getCurrentAuthState()===this.getLoginCompleteState()}})}),define("authentication/models/UserModel",["backbone"],function(e){var t="ActiveXObject"in window;return e.Model.extend({idAttribute:"userId",defaults:{isNewRegistration:!1},url:function(){return site_root+"_ajax/User/Users/"},isPro:function(){return"Real Estate Pro"===this.get("userStatus")},validate:function(e){return this._isValidEmail(e.email)?""===e.p?"Please enter a password.":e.p&&(e.p.length<window._MIN_PASSWORD_LENGTH||e.p.length>window._MAX_PASSWORD_LENGTH)?"Please enter a password between "+window._MIN_PASSWORD_LENGTH+"-"+window._MAX_PASSWORD_LENGTH+" characters":void 0:"Please enter a valid email address."},resetPassword:function(e,t){var e=e||null,t=t||{};return t.url=this.url()+"resetpassword/",this.save(e,t)},login:function(e,t){var e=e||null,t=t||{};return t.url=this.url()+"login/",this.save(e,t)},loginByToken:function(e,t){var e=e||null,t=t||{};return t.url=this.url()+"login_by_token/",t.validate=!1,this.save(e,t)},_isValidEmail:function(e){var t=/^(.+)@(.+)$/;return t.test(e)}})}),define("authentication/models/AuthModalContent",["backbone"],function(e){return e.Model.extend({defaults:{header:"Sign in or register to save a home",subheader:"",agent_signup_cta:"",agent_signup_redirect_url:"",login_header:"Welcome back!<br>Enter your password",create_password_header:"Create a password"}})}),define("tpl!authentication/templates/authModalContainer",[],function(){return function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="loginModalNew" class="modal modalResponsive box backgroundBasic txtC phn">\n  <div class="boxBody pal">\n    <button class="boxClose" data-role="popup_close">\n      <span class="typeLowlight" role="presentation">&times;</span>\n      <span class="hideVisually">Close</span>\n    </button>\n    <div data-role="popupBody"></div>\n  </div>\n</div>';return __p}}),define("authentication/views/AuthModalView",["backbone","tpl!authentication/templates/authModalContainer"],function(e,t){return e.View.extend({modalCfg:{mode:"float",overlay:"dark",closable:!0},_currentView:null,_isModalOpen:!1,events:{"modal:close":"_postCloseModal","modal:open":"_postOpenModal"},initialize:function(e){this.authEventDispatcher=e.authEventDispatcher,this.setElement(t()),this._setElementReferences()},openModal:function(){this.$el.modal(this.modalCfg),this.$el.modal("open")},closeModal:function(){this.$el.modal("close")},setView:function(e){this._currentView&&this._currentView.remove(),this._currentView=e,this.$el.find("[data-role=popupBody]").html(this._currentView.render())},_emptyBody:function(){this.$el.find("[data-role=popupBody]").empty()},_setElementReferences:function(){var e=$('<div class="oocss pan row"></div>');e.append(this.$el),$("body").append(e)},_postOpenModal:function(){this._isModalOpen=!0},_postCloseModal:function(){this._isModalOpen&&(this.authEventDispatcher.trigger("postCloseModal"),this._emptyBody(),this._isModalOpen=!1)}})}),define("authentication/auth_main",["globals","authentication/models/UserAuthContext","authentication/models/AuthTrackingContext","authentication/AuthEventDispatcher","authentication/tracking/AuthTrackingController","authentication/AuthController","authentication/models/AuthStateModel","authentication/models/UserModel","authentication/models/AuthModalContent","authentication/views/AuthModalView"],function(e,t,o,n,i,a,r,s,l,u){var c=new l,d=new o,_=new u({authEventDispatcher:n}),p=new s,h=new i({authEventDispatcher:n}),f=new r;return{setHeader:function(e,t){return c.set("header",e),c.set("subheader",t),this},setLoginHeader:function(e){return c.set("login_header",e),this},setAgentSignUpCTA:function(e){return c.set("agent_signup_cta",e),this},setCreatePasswordHeader:function(e){return c.set("create_password_header",e),this},setEmail:function(e){return p.set("email",e),this},setTrackingContext:function(e){return d.set(e),this},setAuthStateModelToLoginState:function(){return f.setLoginState(),this},setAuthStateModelToRegisterState:function(){return f.setRegisterState(),this},resetPassword:function(){return p.resetPassword({email:p.get("email")},{validate:!0,type:"post"}),this},setAgentRedirectUrl:function(e){c.set("agent_signup_redirect_url",e)},login:function(o,n,i){var a=$.Deferred(),r=n?n:p,s=i?i:f;if(e.isUserLoggedIn)return a.resolve(r);c.get("agent_signup_redirect_url")||c.set("agent_signup_redirect_url",document.location.href);var l=new t(o),u=this._getController(a,r,s,l);return u.login()},autoLogin:function(e){var o=$.Deferred(),n=new t(e),i=this._getController(o,void 0,void 0,n);i.autoLogin()},_getController:function(e,t,o,i){t=t||p,o=o||f;var r=new a({authModalContent:c,userModel:t,authStateModel:o,authModalView:_,authEventDispatcher:n,deferred:e});return r.setUserAuthContext(i),r.setAuthTrackingContext(d),r},autoRegister:function(t){var o=$.Deferred();if(e.isUserLoggedIn)return o.resolve(p);if(!this._hasUserModelEmail())throw new Error("Email is required to auto-register");return this._autoRegisterWithPasswordPrompt(o,t)},autoRegisterWithoutPassword:function(t){var o=$.Deferred();if(e.isUserLoggedIn)return o.resolve(p);if(!this._hasUserModelEmail())throw new Error("Email is required to auto-register");return this._autoRegisterWithoutPassword(o,t)},completeAutoRegister:function(t){var o=$.Deferred();return e.isUserLoggedIn&&!p.get("isNewRegistration")?o.resolve(p):this._showPasswordUpdatePrompt(o,t)},_hasUserModelEmail:function(){return!!p.get("email")},_autoRegisterWithoutPassword:function(e,o){var n=this._getController(e,void 0,void 0,new t(o));return n.autoRegisterWithoutPassword(p.get("email"))},_autoRegisterWithPasswordPrompt:function(e,o){var n=this._getController(e,void 0,void 0,new t(o));return n.autoRegister(p.get("email"))},_showPasswordUpdatePrompt:function(e,o){var n=this._getController(e,void 0,void 0,new t(o));return n.login()},logout:function(){var e=this._getController($.Deferred(),p,f,new t);e.logout()}}}),trulia=trulia||{},trulia.globals=trulia.globals||{},trulia.errors=trulia.errors||{},trulia.globals.MODAL_MUTEX="modal mutex",trulia.globals.STATS_LAYER_MUTEX="stats layer mutex",trulia.globals.voices=trulia.globals.voices||{},trulia.globals.voices.VOTE_USEFUL="useful",trulia.globals.voices.VOTE_NOT_USEFUL="not useful",trulia.globals.voices.MIN_QUESTION_TITLE_LENGTH=15,trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH=150,trulia.globals.voices.MIN_QUESTION_BODY_LENGTH=5,trulia.globals.voices.MAX_QUESTION_BODY_LENGTH=1e3,trulia.globals.voices.MIN_DISCUSSION_TITLE_LENGTH=15,trulia.globals.voices.MAX_DISCUSSION_TITLE_LENGTH=150,trulia.globals.voices.MIN_DISCUSSION_BODY_LENGTH=5,trulia.globals.voices.MAX_DISCUSSION_BODY_LENGTH=3e3,trulia.globals.voices.DEFAULT_QUESTION_TEXT="Your question",trulia.globals.voices.DEFAULT_PROMO_ASK_CONTENT_SYNDICATION="Ask real estate experts, locals, and friends...",trulia.globals.voices.DEFAULT_PROMO_ASK_DETAILS_CONTENT_SYNDICATION="Optional details about your question",trulia.globals.voices.DISCUSSION_ERROR_LABELS={title_missing:"Please enter a title for your discussion.",discussion_too_short:"Sorry, your title is too short. A minimum of 15 characters is needed.",discussion_too_long:"Sorry, your title is too long. Titles cannot be longer than 150 characters.",body_too_short:"Sorry, your description is too short. A minimum of 5 characters is needed.",body_too_long:"Sorry, your description is too long. Descriptions cannot be longer than 1000 characters.",location:"No location match found for city & state, or ZIP.",no_location:"Please enter a location.",category:"Please select a category.",error_summary:'<span class="error_title"><strong>Sorry!</strong> There were errors. Please see below for details.</span>'},trulia.globals.voices.DISCUSSION_ERROR_FIELD_MAP={title_missing:"error_discussionTitle",discussion_too_short:"error_discussionTitle",discussion_too_long:"error_discussionTitle",body_too_short:"error_discussionBody",body_too_long:"error_discussionBody",category:"error_discussionCategory",location:"error_discussionLocation",no_location:"error_discussionLocation"},trulia.globals.voices.QA_DEFAULT_FIELDS={questionTitle:trulia.globals.voices.DEFAULT_QUESTION_TEXT,questionBody:trulia.globals.voices.DEFAULT_PROMO_ASK_DETAILS_CONTENT_SYNDICATION},trulia.globals.voices.QA_ERROR_FIELD_MAP={question_missing:"error_questionTitle",question_too_short:"error_questionTitle",question_too_long:"error_questionTitle",body_too_short:"error_questionBody",body_too_long:"error_questionBody",category:"error_questionCategory",location:"error_questionLocation",no_location:"error_questionLocation",captcha:"error_questionCaptcha",no_captcha:"error_questionCaptcha",bad_friend_email:"error_friendEmail"},trulia.globals.voices.COMMENT_ERROR_LABELS={comment_missing:"Please enter a comment.",no_captcha:"Please type the code shown."},trulia.globals.voices.COMMENT_ERROR_FIELD_MAP={comment_missing:"error_post_comment",captcha:"error_questionCaptcha",no_captcha:"error_questionCaptcha"},trulia.globals.voices.ANSWER_ERROR_LABELS={answer_missing:"Please enter an answer.",answer_too_short:"Sorry, your answer is too short. A minimum of 25 characters is needed.",answer_too_long:"Sorry, your answer is too long. Answers cannot be longer than 5000 characters.",captcha:"Please enter the correct text in the input box.",no_captcha:"Please enter the correct text in the input box."},trulia.globals.voices.ANSWER_ERROR_FIELD_MAP={answer_missing:"error_answer_body",answer_too_short:"error_answer_body",answer_too_long:"error_answer_body",captcha:"error_questionCaptcha",no_captcha:"error_questionCaptcha"},trulia.errors.voices=trulia.errors.voices||{},trulia.errors.voices.CANNOT_VOTE_FOR_SELF=-3,trulia.globals.voices.formTimeout={},trulia.voices=function(){var e={};return e.jumpToLocation=function(e){var t=$(this).attr("id").replace(/_form$/,"").replace(/_btn$/,""),o=$("#"+t).val(),n=$("#"+t+"_autocomplete_value").val(),i=_.compact(window.location.pathname.split("/"));return e.preventDefault(),doNothing(e),n?void(window.location=site_root+"voices/qa/"+o.replace(/ - /g," ").replace(/[, \/]/g,"_").replace(/__/g,"_")+"---"+n):void $("#"+t+"_browse_loc_error").show()},e}(),trulia.voices.UgcFormManager=function(){var e={},t={};return e.initForm=function(e,o){var n=new trulia.voices.UgcForm;return n.setup(e,o),t[e.id]=n,n},e.getForm=function(e){return t[e]?t[e]:!1},e.getAll=function(){return t},e.isSourceTracked=function(e,t){var o=["AskQuestion_MarketConditions","AskQuestion_Schools","AskQuestion_Crime","AskQuestion_Community"],n="undefined"!=typeof t?t:o;return _.contains(n,e)?!0:!1},e}(),trulia.voices.setupAskStandaloneForm=function(e){var t={loginFormId:"login_ask_page"},o;e.from_source_name&&e.from_source_name.value&&(o=e.from_source_name.value,trulia.voices.UgcFormManager.isSourceTracked(o)===!0&&(t.registrationSource="ask_page_"+o));var n=trulia.voices.UgcFormManager.initForm(e,{contentType:"Q",loginCfg:t,loginFormId:"login_ask_page",formSubmitOmniCode:"BelowAskQuestionModule|AskQuestion_Button",formFieldValidation:{questionTitle:"",questionBody:""}})},trulia.voices.setupAskOpenForm=function(e){var t=e.id,o={contentType:"Q",ajaxEndpoint:"q_ask_question.php"};"ask_question_form_RQ"===t?(o.loginFormId="login_ask_recent",o.formSubmitOmniCode="RecentDiscModule|AskButton",o.formFieldValidation={questionTitle:"",questionBody:""}):(o.formFieldValidation={questionTitle:/^have a question about [\w]+\? enter it here.$/,questionBody:""},o.loginCfg={id:"login_pdp_ask"});var n=trulia.voices.UgcFormManager.initForm(e,o);"ask_question_form_RQ"===t&&n.setFormPreprocessFunction(function(){var t,o,n=e.questionTitle.value,i=e.questionBody.value;if(!(n.length<=trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH)){if(-1!==n.indexOf("?")&&n.indexOf("?")<trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH)for(o=n.indexOf("?");o<trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH;)t=o,o=n.indexOf("?",t+1);else if(-1!==n.indexOf(" ")&&n.indexOf(" ")<trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH)for(o=n.indexOf(" ");o<trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH;)t=o,o=n.indexOf(" ",t+1);else t=trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH;i=n.substr(t)+(i.length>0?" "+i:""),n=n.substr(0,t),e.questionTitle.value=n,e.questionBody.value=i.substr(0,trulia.globals.voices.MAX_QUESTION_BODY_LENGTH)}}),n.setAjaxFormSubmitSuccessCallback(function(t){var o=$(e).parent().find(".feedback_message_container"),i=e.source_id&&e.source_id.value?e.source_id.value:"pdpDirectAsk";n.showConfirmationPopup(t.popup_header,t.html,{popupId:"direct_ask_popup"+e.id}),$(e).find('input[type="text"], textarea').val(""),o_track_qa_event(i,e.categoryId.value,"Q"),o_track_ask_submit_qa_event(t.data.question_id,i,"Q",e.categoryId.value,e.questionLocationId.value)})},trulia.voices.setupActivityStreamUgcForm=function(e,t){var o=e.suffix?e.suffix.value:null,n={contentType:t,loginCfg:{preventReloadAfterComplete:!0},formFieldValidation:{questionTitle:"",questionBody:""}};"Q"===t?(n.ajaxEndpoint="q_ask_question.php",n.loginCfg.id="login_ask_activity_stream",n.formSubmitOmniCode="AskQuestBox|Submit",n.formFieldValidation={questionTitle:"",questionBody:""}):(n.ajaxEndpoint="q_post_discussion.php",n.loginCfg.id="login_discuss_activity_stream"+o,n.formSubmitOmniCode="_DAS"===o?"PostDiscussionBox|Submit":"PostImageBox|Submit",n.supportsImageUpload=!0);var i=trulia.voices.UgcFormManager.initForm(e,n);"D"===t?($(e).find(".discussion_title").click(function(){o_track_ql_click("discussionsLeftColumn")}),$(e).find(".discussion_title").focus(function(e){var t=$(e.target).closest("form");t.hasClass("minimal")&&("_DPAS"===o&&(t.find(".image_upload_widget_wrapper").fadeIn(1e3),t.find(".add_photos").hide()),t.removeClass("minimal"),o_track_qa_event("discussion_module",t[0].categoryId.value||0,"D"))}),$(e).find(".add_photos").click(function(){$(this).hide(),$(e).find(".image_upload_widget_wrapper").fadeIn(1e3)})):($(e).find("#question_title").click(function(){$(".ask_form_extended_section").show(),o_track_ql_click("questionsLeftColumn")}),$(e).find("#question_title").focus(function(){$(e).hasClass("minimal")&&($(e).removeClass("minimal"),o_track_qa_event("question_module",e.categoryId.value||0,"Q"))})),i.setAjaxFormSubmitSuccessCallback(function(o){var n="Q"===t?o.data.question_id:o.data.discussion_id,i="Q"===t?e.questionLocationId.value:e.discussionLocationId.value;0===o.errors.length&&o_track_ask_submit_qa_event(n,"inlineUgcForm",t,e.categoryId.value,i),o.data.activity_stream_url?window.location.href=o.data.activity_stream_url:window.location.reload()})},trulia.voices.setupAskFormPopup=function(e){var t={loginFormId:"login_ask_popup"},o=["location_overview","location_market_trends","location_schools","location_crime","location_community"];trulia.voices.UgcFormManager.isSourceTracked(trulia.page_name,o)===!0&&(t.registrationSource="ask_popup_"+trulia.page_name);var n=trulia.voices.UgcFormManager.initForm(e,{contentType:"Q",ajaxEndpoint:"q_ask_question.php",loginCfg:t,formFieldValidation:{questionTitle:/^have a question about [\w]+\? enter it here.$/,questionBody:""}});n.setAjaxFormSubmitSuccessCallback(function(t){var o=$("#"+e.id).parent().find(".feedback_message_container")[0],i=e.omni_code&&e.omni_code.value?e.omni_code.value:"V100011";n.showConfirmationPopup(t.popup_header,t.html,{popupId:"direct_ask_popup"+e.id}),$(e).find('input[type="text"], textarea').val(""),o_track_ask_submit_qa_event(t.data.question_id,i,"Q",e.categoryId.value,e.questionLocationId.value)}),n.setAjaxFormPostLoginSubmitFailureCallback(function(e){trulia._popup_panel_cache.ask_question_popup.unhide()}),$(e).find("#popupQuestionLocation").autosuggest({display:{tracking_string:"voicesPopup",value_field:"#popupQuestionLocationId",show_hint:!1}})},trulia.voices.setupAnswerQuestionForm=function(e){var t=trulia.voices.UgcFormManager.initForm(e,{contentType:"A",loginFormId:"login_answer"})},trulia.voices.setupCommentForm=function(e,t){var o=trulia.voices.UgcFormManager.initForm(e,$.extend({contentType:"C",loginFormId:"login_comment"},t));return o},trulia.voices.UgcFormPopup=function(){var e={};return e.showAskPopup=function(e,t,o){var n="ask_question_popup",i=new trulia.Popup({id:n,width:"562px",close:!0,cache_endpoint:!1,destroy_on_cancel:!0}),a="ask_question_form_popup",r="";o=o||{},r="?location_id="+e+"&category_id="+t,_.each(o,function(e,t){r+="&"+t+"="+encodeURIComponent(e)}),i.setContentSource("_ajax/Voices/AskQuestionAjax/get_form/"+r),i.setOnReadyCallback(function(){trulia.voices.setupAskFormPopup($("#"+a)[0])}),i.show();var s=trulia.voices.seekReCaptchaSuffix();$("#"+n).on("destroy.popup",function(){trulia.voices.showRecaptchaOnSelectedForm(s)})},e.showAskAboutPropertyPopup=function(t,o,n){var i="AskQuestion_Toolbar";o_track_qa_event(i,o,"Q"),e.showAskPopup(t,o,{from_id:trulia.propertyData.get().id,from_type:"property",from_url:window.location.href,omni_code:i,from_contact:n?1:0})},e.showAskPopupFromForm=function(t,o){var n={},i,a;$.each($(t).serializeArray(),function(e,t){return"main_loc_id"===t.name||"locationId"===t.name?void(i=t.value):"categoryId"===t.name?void(a=t.value):void(n[t.name]=t.value)}),o&&(n.cat_select=!0),n.omni_code=n.from_where,e.showAskPopup(i,a,n)},e}(),trulia.voices.UgcForm=function(){function e(e,t,o){var n="";h&&("object"==typeof o&&_.each(o,function(e,t){e&&(n+=encodeURI(t)+"="+encodeURI(e)+"&")}),$.post(site_root+T,$(h).serialize()+"&"+n,function(o){switch("undefined"!=typeof o.success&&(o.status=o.success?trulia.globals.AJAX_STATUS_SUCCESS:trulia.globals.AJAX_STATUS_FAILURE),o.status){case trulia.globals.AJAX_STATUS_SUCCESS:"function"==typeof e&&e(o);break;case trulia.globals.AJAX_STATUS_FAILURE:"function"==typeof t&&t(o),o.errors&&(x&&$(x).html('<span class="error_title">'+o.message+"</span>").show(),o.errors.fields&&_.each(o.errors.fields,function(e,t){$("#error_"+t+f).html(e).show()}))}},"json"))}function t(){var e=trim(h.answer_body.value),t="undefined"!=typeof h.answerCaptcha?trim(h.answerCaptcha.value):null;return""===e?F.add("answer_missing"):e.length<25?F.add("answer_too_short"):e.length>5e3&&F.add("answer_too_long"),""===t&&F.add("no_captcha"),F.is_empty()?(h.question_email.checked&&o_track_email_signup("answer"),!0):(r(),!1)}function o(){var e=trim(h.post_comment.value),t="",o="undefined"!=typeof h.captcha;return I[p]?!1:(I[p]=!0,o&&(t=h.captcha.value),o&&""===t&&F.add("no_captcha"),""===e&&F.add("comment_missing"),F.is_empty()?(I[p]=!1,!0):(r(),I[p]=!1,!1))}function n(){var e=trim(h.discussionTitle.value),t=trim(h.discussionBody.value),o=parseInt(h.categoryId.value,10),n=[],i=0,a=0;return""===e||e===$(h.discussionTitle).attr("placeholder")?(F.add("title_missing"),n.push("discussion_none")):e.length<trulia.globals.voices.MIN_DISCUSSION_TITLE_LENGTH?(F.add("discussion_too_short"),n.push("discussion_short")):e.length>trulia.globals.voices.MAX_DISCUSSION_TITLE_LENGTH&&(F.add("discussion_too_long"),n.push("discussion_long")),""!==t&&(t.length<trulia.globals.voices.MIN_DISCUSSION_BODY_LENGTH?(F.add("body_too_short"),n.push("discussion_body_short")):t.length>trulia.globals.voices.MAX_DISCUSSION_BODY_LENGTH&&(F.add("body_too_long"),n.push("discussion_body_long"))),o||(F.add("category"),n.push("discussion_category")),F.is_empty()?((h.discussionEmail.checked||"hidden"===h.discussionEmail.type&&"1"===h.discussionEmail.value)&&o_track_email_signup("comment"),!0):(r(),process_qa_omni_errors(n),!1)}function i(){var e=trim(h.questionTitle.value),t=trim(h.questionBody.value),o,n="",i="undefined"!=typeof h.questionCaptcha,a=parseInt(h.categoryId.value,10),s=[],l,u=$(x).position(),c=0,d=0;return l="object"==typeof v.questionTitle?v.questionTitle:"/^"+v.questionTitle.toLowerCase()+"$/",(e.toLowerCase().match(l)||e===$(h.questionTitle).attr("placeholder"))&&(e=""),(t.toLowerCase()===v.questionBody.toLowerCase()||t===$(h.questionBody).attr("placeholder"))&&(t=""),i&&(n=h.questionCaptcha.value),""===e?(F.add("question_missing"),s.push("question_none")):e.length<trulia.globals.voices.MIN_QUESTION_TITLE_LENGTH?(F.add("question_too_short"),s.push("question_short")):e.length>trulia.globals.voices.MAX_QUESTION_TITLE_LENGTH&&(F.add("question_too_long"),s.push("question_long")),""!==t&&(t.length<trulia.globals.voices.MIN_QUESTION_BODY_LENGTH?(F.add("body_too_short"),s.push("question_body_short")):t.length>trulia.globals.voices.MAX_QUESTION_BODY_LENGTH&&(F.add("body_too_long"),s.push("question_body_long"))),a||(F.add("category"),s.push("question_category")),i&&""===n&&(F.add("no_captcha"),s.push("question_captcha")),F.is_empty()?((h.questionEmail.checked||"hidden"===h.questionEmail.type&&"1"===h.questionEmail.value)&&(o=h.emailSignupType?h.emailSignupType.value:"answer",o_track_email_signup(o)),!0):(r(),process_qa_omni_errors(s),!1)}function a(){$(x).html("").hide(),$(h).find(".qa_error").html("").hide()}function r(){var e,t,o,n;for(F.it_start(),o=F.it_next_element();o;)"undefined"!=typeof L[o]&&$("#"+L[o]+f).html(M[o]).show(),o=F.it_next_element();x&&($(x).html(M.error_summary).show(),A&&(n=$(x).position(),n&&n.x&&n.y&&(e=n.x,t=n.y-100),window.scroll(e,t)))}function s(t){$(h).find(".submit_button").click(function(){return $(h).submit(),!1}),$(h).submit(function(o){var n,i;return C&&o_track_ql_click(C),"function"!=typeof E||E()?("function"==typeof S&&S(),n=l(m),a(),F.clear(),n!==!1&&n()?_trulia_logged_in?T?(e(R,null,t),!1):!0:(u(t,m),!1):!1):!1})}function l(e){var a;switch(e){case"A":a=t;break;case"C":a=o;break;case"D":a=n;break;case"Q":a=i;break;default:a=!1}return a}function u(t,o){var n="Sign in or register",i="",a={};switch(o){case"A":n+="<br>to answer a question",a.flowName="login_answer";break;case"C":n+=" to comment",a.flowName="login_comment";break;case"D":n+=" to discuss",a.flowName="login_discuss_activity_stream";break;default:n+="<br>to ask your question",a.flowName="ask_question"}require(["authentication/auth_main"],function(o){o.setHeader(n),o.setTrackingContext(a),o.login().done(function(){T?e(R,P,t):$(h).submit()})})}function c(){$(h).find(".cancel_link").click(function(e){g||(e.preventDefault(),doNothing(e),a(),$(h).addClass("minimal")[0].reset(),"ask_question_form_QAS"==h.id&&$(".ask_form_extended_section",h).hide())})}var d={},p,h,f,m,g=!1,v={},w,y,b=!1,k,C,S,E,T,R,P,x,A,M,L,F=new Queue(10),I={};return d.setup=function(e,t){switch(h=e,p=h.id,f=h.suffix?h.suffix.value:"",x=$(h).find('.qa_error_summary [id^="error_summary"]')[0],g="ask_question"===$("body").attr("id"),m=t.contentType,T=t.ajaxEndpoint?t.ajaxEndpoint:null,w=t.loginCfg?t.loginCfg:{id:t.loginFormId},A="boolean"==typeof t.errorSummaryScroll?t.errorSummaryScroll:!1,C=t.formSubmitOmniCode?t.formSubmitOmniCode:null,v=t.formFieldValidation?t.formFieldValidation:{},m){case"A":M=trulia.globals.voices.ANSWER_ERROR_LABELS,L=trulia.globals.voices.ANSWER_ERROR_FIELD_MAP;break;case"C":M=trulia.globals.voices.COMMENT_ERROR_LABELS,L=trulia.globals.voices.COMMENT_ERROR_FIELD_MAP;break;case"D":M=trulia.globals.voices.DISCUSSION_ERROR_LABELS,L=trulia.globals.voices.DISCUSSION_ERROR_FIELD_MAP;break;case"Q":M=_QA_ERROR_LABELS,L=trulia.globals.voices.QA_ERROR_FIELD_MAP}s(t.successHandlerOptions),c()},d.setFormPreValidateFunction=function(e){E=e},d.setFormPreprocessFunction=function(e){S=e},d.setAjaxFormSubmitSuccessCallback=function(e){R=e},d.setAjaxFormPostLoginSubmitFailureCallback=function(e){P=e},d.showConfirmationPopup=function(e,t,o){o=$.extend({popupId:"voices_ugc_submit_confirmation_popup",header:"",body:"",width:"450px",close:!0,cache_endpoint:!1,destroy_on_cancel:!0},o);var n=new trulia.Popup({id:o.popupId,width:o.width,close:o.close,cache_endpoint:o.cache_endpoint,destroy_on_cancel:o.destroy_on_cancel});n.setHeader(e),n.setBody(t),n.show();var i=trulia.voices.seekReCaptchaSuffix();return $("#"+n.id).on("destroy.popup",function(){trulia.voices.showRecaptchaOnSelectedForm(i)}),"function"==typeof o.ctaButtonClickHandler&&$("#"+n.id).find(".btnPrimary").on("click",function(e){o.ctaButtonClickHandler(n,e)}),n},d},trulia.voices.showRecaptcha=function(e,t){$.ajax({url:site_root+"recaptcha/",success:function(o){$("#recaptchaWrapper_"+e).empty(),$("#recaptchaWrapper_"+t).html(o)}})},trulia.voices.showRecaptchaOnSelectedForm=function(e){try{$.ajax({url:site_root+"recaptcha/",error:function(){$("#recaptchaWrapper_"+e).html("Unable to load ReCaptcha")},success:function(t){$("#recaptchaWrapper_"+e).html(t)}})}catch(t){}},trulia.voices.seekReCaptchaSuffix=function(){var e="";return e=$("div.form_toggle").find("a.notlink").data("suffix"),$("#recaptchaWrapper_"+e).empty(),e};var FindAPro=FindAPro||{};FindAPro.Form=function(){return{validate_find_pro:function(e){return"Enter keyword or name"!==e.q.value&&0!==e.q.length||"City & State, or ZIP"!==e.location.value&&0!==e.location.value.length?($("#pro_location_error").addClass("hidden"),!0):($("#pro_location_error").removeClass("hidden"),e.location.focus(),!1)}}}(),FindAPro.Badges=function(){var e=this,t;return{init:function(e){this.id="fap_results_list",this.get_badges(e)},add_trulian_icon:function(e){t='<span class="imgsheet trulian_icon" title="I work at Trulia"></span>\n',$(e).append(t)},add_pro_icon:function(e){t='<a class="imgsheet pro_icon" rel="nofollow" title="Trulia Pro" href="'+site_root+'truliapro/?src=000038"></a>\n',$(e).append(t)},add_trulia_pro_icon:function(e){t='<a class="imgsheet pro_icon" rel="nofollow" title="Trulia Pro" href="'+site_root+'truliapro/?src=000038"></a>\n',$(e).append(t)},add_mayor_icon:function(e){t='<a class="imgsheet mayor_icon" rel="nofollow" title="Trulia Mayor" href="'+site_root+'community-blog/discovertrulia/2009/09/announcing_the_trulia_mayors"></a>\n',$(e).append(t)},add_mvp_icon:function(e){t='<span title="MVP" onclick="show_pos_menu(event, \'mvp_popup\', -220, 20); return false;" class="voices_mvp clickable"><span class="voices_mvp_label">MVP</span><span class="voices_mvp_year">\'08</span></span>\n\n',$(e).append(t)},get_badges:function(e){$(".badges").each(function(t){e[this.id].trulian&&FindAPro.Badges.add_trulian_icon(this),e[this.id].pro_icon&&FindAPro.Badges.add_pro_icon(this),e[this.id].trulia_pro&&FindAPro.Badges.add_trulia_pro_icon(this),e[this.id].mayor&&FindAPro.Badges.add_mayor_icon(this),e[this.id].mvp&&FindAPro.Badges.add_mvp_icon(this)})}}}(),$(document).ready(function(){if($(".autosuggest_location").autosuggest({data:{types:["neighborhood","zipCode","city","county","state"]},display:{no_results_message:"We couldn't find a matching location. Please try again.",allow_invalid:"find_a_pro"===trulia.page_name,tracking_string:"find_a_pro"===trulia.page_name?"fap":"voices",value_field:".autosuggest_location_value",show_hint:!1,submit_on_enter_select:!1}}),$("#recent_question_ask_form").submit(function(e){e.preventDefault(),trulia.voices.UgcFormPopup.showAskPopupFromForm(this,!0)}),$(".form_toggle a.tooltipped").tooltip({anchor:"top",offset:"0x10"}),$(".post_content_form").length){var e=this;$(".ugc_form_wrapper .form_toggle a").click(function(e){var t=$(e.target).is("a")?$(e.target):$(e.target).closest("a"),o=t.closest(".ugc_form_wrapper").first(),n=o.find(".form_toggle").first(),i=o.find(".cta-indicator").first(),a=t.data("suffix"),r=i.data("selected-suffix");t.hasClass("notlink")||(n.find(".suffix-"+a).addClass("notlink"),n.find(".suffix-"+r).removeClass("notlink"),i.data("selected-suffix",a).removeClass("suffix-"+r).addClass("suffix-"+a),o.find(".post_content_form").each(function(){(-1!==$(this).attr("id").indexOf(a)||-1!==$(this).attr("id").indexOf(r))&&$(this).toggle()}),trulia.voices.showRecaptcha(r,a))}),$(".post_content_form").each(function(e,t){switch(t.id){case"post_comment_form":trulia.voices.setupCommentForm(t);break;case"answer_question_form":trulia.voices.setupAnswerQuestionForm(t);break;case"ask_question_form":trulia.voices.setupAskStandaloneForm(t);break;case"ask_question_form_RQ":trulia.voices.setupAskOpenForm(t);break;case"ask_question_form_QAS":trulia.voices.setupActivityStreamUgcForm(t,"Q")}})}$("#question_bubble_form").submit(function(e){return e.preventDefault(),o_track_qa_event("AskQuestionBubble","0","Q"),trulia.voices.UgcFormPopup.showAskPopup($('[name="main_loc_id"]',this).val(),$('[name="categoryId"]',this).val(),{omni_code:$('[name="from_where"]',this).val(),cat_select:!0,questionTitle:$('[name="questionTitle"]',this).val()}),!1
}),$(".ask_quick_form").each(function(){var e=this,t=$("input[name=suffix]",this).val(),o=$("#recaptcha"+t+"_modal",this);o.modal({fixed:!0,overlay:"light",closeable:!0,width:490}),o.find("#ask_question_form"+t+"_submit").on("click",function(){o.modal("close")}),o.on("modal:close",function(){$("input[name=recaptcha_challenge]",e).val($("#recaptcha_challenge_field").val()),$("input[name=recaptcha_response]",e).val($("#recaptcha_response_field").val()),$(".ask_question_form_error_wrapper",e).children().hide(),$("#recaptchaWrapper"+t).empty()}),$("#ask_community"+t).click(function(e){e.preventDefault(),o.css({top:"100px"}),$.ajax({url:site_root+"recaptcha/",error:function(e){$("#recaptchaWrapper"+t).html("Unable to load ReCaptcha. Please close the window and try again."),o.modal("open")},success:function(e){$("#recaptchaWrapper"+t).html(e),o.modal("open")}})})})}),$(document).bind("loggedInFinal.auth",function(e,t,o,n){_.contains(["advice_opinions","qa_home","blogs_home","discussions_home","guides_home"],trulia.page_name)&&n===!1?window.location.reload():$("#qa_email_alert_quick_email_id").val("-1")}),$(document).bind("loggedOut.auth",function(){_.contains(["advice_opinions","qa_home","blogs_home","discussions_home","guides_home","ask_question","blog","blog_post","guide_post"],trulia.page_name)&&window.location.reload()}),define("trulia.voices",function(){});var _content_type_def={q:"question",a:"answer",p:"profile",b:"post",d:"post",g:"post",c:"comment",r:"review",y:"reply",ay:"reply"},AuthPopup={};require(["authentication/auth_main"],function(e){AuthPopup=e});var _loc_lookup=!1,_profile_stats,_up_layer_show=!1;$(document).ready(function(){$("#email_alert_form_b #email_alert_location").autosuggest({display:{value_field:"#autocomplete_email_location"}})}),Menu.prototype.add_item=function(e,t){this.items.push({text:e,action:t})},Menu.prototype.add_close=function(){this.close=!0},Menu.prototype.position=function(e,t){this.x=e,this.y=t},Menu.prototype.build=function(){""!=this.title&&this.container.appendChild($$("span","<strong>"+this.title+"</strong>"));var e=$$("ul");e.className="flist";var t;for(t in this.items){var o=$$("li",this.items[t].text);"undefined"!=typeof this.items[t].action&&(o.className="pseudolink",o.onclick=this.items[t].action),e.appendChild(o)}if(this.container.appendChild(e),this.add_close){var n=$$("p",'<span class="pseudolink" onclick="close_flag_menu()">[x] Close</span>');n.className="tiny",n.style.textAlign="right",this.container.appendChild(n)}},Menu.prototype.show=function(){this.container.style.left=this.x+"px",this.container.style.top=this.y+"px",this.container.style.position="absolute",this.container.style.display="inline",this.container.className="menu_contents",this.container.id=this.menu_id,document.body.appendChild(this.container)},$(document).ready(function(){var e,t,o=$("#more_categories"),n=!1,i;switch($(".popup_table_widget").click(function(e){if(e&&e.target){var t=$(e.target).parent().find(".sort_dropdown");t&&t.length&&($(".sort_dropdown").filter(function(){return t[0]!=this}).hide(),t.toggle())}}),$(".popup_table_new").find("li").click(function(e){e&&e.target&&(window.location.href=$(e.target).data("url"))}),$("#voices_nav_more_tab").hover(function(e){$(this).addClass("hover"),o.show()},function(e){var t=this;setTimeout(function(){n||($(t).removeClass("hover"),o.hide())},50)}),$("#more_categories").hover(function(e){n=!0},function(e){n=!1,$("#voices_nav_more_tab").removeClass("hover"),o.hide()}),trulia.page_name){case"qa_home":case"discussions_home":!window.location.hash||-1===window.location.hash.indexOf("#asked_question")&&-1===window.location.hash.indexOf("#posted_discussion")||trulia.justPostedOrAsked.trackEvent();break;case"question_details":case"question_answer":var a=$("#web_reference"),r=$("#recaptchaWrapper"),s=$("#answer_body"),l=!1;a.click(function(){a.find("a").first().hide(),$(".webReferenceSection").removeClass("hideFully")}),s.focus(function(){var e=$("#answer_email_box"),t=160;l||(s.css("height",parseInt(s.css("height"))+t+"px"),r.show(),"undefined"!=typeof grecaptcha&&grecaptcha.reset(),a.show(),a.find("a").first().show(),e.hasClass("following")||e.show(),l=!0)}),$("#questionTitle").focus(function(){$(".question_list .ask_form .button").show()});break;case"discussion":var u=$("#post_comment"),c=$("#answer_email_box"),d=!1;u.focus(function(){var e=160;d||(u.css("height",parseInt(u.css("height"))+e+"px"),d=!0,$("#recaptchaWrapper").show(),c.hasClass("following")||c.show())}),$.ajax({url:site_root+"recaptcha/",success:function(e){$("#recaptchaWrapper").html(e)}})}}),define("qa",function(){}),window.xb_get_element=function(e){return"string"==typeof e?$("#"+e)[0]:e},window.mkEl=function(e,t,o,n){var i=document.createElement(e);return"undefined"!=typeof t&&null!=t&&(i.innerHTML=t),"undefined"!=typeof o&&null!=o&&(i.id=o),"undefined"!=typeof n&&null!=n&&(i.className=n),i},window.toggle_element=function(e,t,o,n){var i=$("#"+e)[0],a=$("#"+e+"_less")[0],r=$("#"+e+"_more")[0],s="string"==typeof t?$("#"+t)[0]:t,l=$(s).find(".triangle");if(a&&r)"none"==r.style.display||$(r).hasClass("hidden")||$(r).hasClass("gone")?(hide(a),unhide(r,""),s&&n&&(s.innerHTML=n)):(hide(r),unhide(a,""),s&&o&&(s.innerHTML=o));else{if(!i)return!1;"none"==i.style.display||$(i).hasClass("hidden")||$(i).hasClass("gone")?(unhide(i,""),s&&n&&(s.innerHTML=n)):(hide(i),s&&o&&(s.innerHTML=o))}l.length&&(l.hasClass("up")?(l.removeClass("up"),l.addClass("down")):(l.removeClass("down"),l.addClass("up")))},window.toggle_element_triangle=function(e,t){var o=$("#"+e)[0];o&&("none"==o.style.display?(unhide(e),toggle_class(t,"srp_filter_open","srp_filter_closed")):(hide(e),toggle_class(t,"srp_filter_closed","srp_filter_open")))},window.clear=function(e){$("string"==typeof e?"#"+e:e).val("")},window.unhide=function(e,t){var o=$("string"==typeof e?"#"+e:e);if(o.length){var n=o.css("display");("undefined"==typeof t||!t&&""!==t||"none"==t)&&(t="none"==n?"inline":""),n&&o.css("display",t),o.removeClass("hidden"),o.removeClass("gone"),o.removeClass("hideFully")}},trulia.unhide=unhide,window.hide=function(e){var t=$("string"==typeof e?"#"+e:e);if(t.length){var o=t.css("display");o||t.css("display",""),t.addClass("hidden hideFully")}},trulia.hide=hide,trulia.block=block,window.clear_element=function(e){(e=$("#"+e)[0])&&(e.innerHTML="")},window.doNothing=function(e){if("undefined"==typeof e||!e)var e=window.event;return e&&"undefined"!=typeof e&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()),!1},window.position_at_event=function(e,t,o,n,i){"undefined"==typeof i&&(i=-10),show_pos_menu(n,e,50,i)},window.getPosition=function(e){var t=$.event.fix(e);return{x:t.pageX,y:t.pageY}},window.f_clientSize=function(){var e=new Object;return e.width=f_clientWidth(),e.height=f_clientHeight(),e.scrollLeft=f_scrollLeft(),e.scrollTop=f_scrollTop(),e},window.f_clientWidth=function(){return f_filterResults(window.innerWidth?window.innerWidth:0,document.documentElement?document.documentElement.clientWidth:0,document.body?document.body.clientWidth:0)},window.f_clientHeight=function(){return f_filterResults(window.innerHeight?window.innerHeight:0,document.documentElement?document.documentElement.clientHeight:0,document.body?document.body.clientHeight:0)},window.f_scrollLeft=function(){return f_filterResults(window.pageXOffset?window.pageXOffset:0,document.documentElement?document.documentElement.scrollLeft:0,document.body?document.body.scrollLeft:0)},window.f_scrollTop=function(){return f_filterResults(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)},window.get_ids_with_prefix=function(e,t){for(var o=new Array,n=document.getElementsByTagName(e),i=0;i<n.length;++i)n[i].id&&0==n[i].id.indexOf(t)&&o.push(n[i].id);return o},window.kill=function(e){$("#"+e).remove()},window.get_object_dimensions=function(e){if(e="string"==typeof e?$("#"+e)[0]:e,!e)return{height:null,width:null};var t=!1;"none"==e.style.display&&(e.style.display="",t=!0);var o=0,n=0;return e.offsetWidth||0===e.offsetWidth?(o=e.offsetWidth,n=e.offsetHeight):document.defaultView.getComputedStyle?(n=document.defaultView.getComputedStyle(e,"").getPropertyValue("height"),o=document.defaultView.getComputedStyle(e,"").getPropertyValue("width")):e.clip&&(o=e.clip.width,n=e.clip.height),t&&(e.style.display="none"),{height:n,width:o}},window.set_opac=function(e,t,o,n){return(e="string"==typeof e?$("#"+e)[0]:e)?("undefined"==typeof t||t>=100?(moz_opac="",ie_opac=""):0>=t?(moz_opac=0,ie_opac=0):(moz_opac=t/100,ie_opac="alpha(opacity="+t+")"),e.style.opacity=moz_opac,e.style.MozOpacity=moz_opac,e.style.KhtmlOpacity=moz_opac,e.style.filter=ie_opac,0>=t&&(e.style.display="undefined"==typeof o||"none"!=o&&"block"!=o&&"inline"!=o?"":o),!0):!1},window.has_class=function(e,t){return $("string"==typeof e?"#"+e:e).eq(0).hasClass(t)},window.add_class=function(e,t){return $("string"==typeof e?"#"+e:e).eq(0).addClass(t).length},trulia.add_class=add_class,window.remove_class=function(e,t){return $("string"==typeof e?"#"+e:e).eq(0).removeClass(t).length},trulia.remove_class=remove_class,window.toggle_class=function(e,t,o){var n=$("string"==typeof e?"#"+e:e);return n.length?(t&&n.addClass(t),o&&n.removeClass(o),!0):!1},window.clone_obj=function(e){if("object"!=typeof e)return null;try{var t=new Object;return"undefined"!=typeof e.pageX&&(t.pageX=e.pageX),"undefined"!=typeof e.pageY&&(t.pageY=e.pageY),"undefined"!=typeof e.clientX&&(t.clientX=e.clientX),"undefined"!=typeof e.clientY&&(t.clientY=e.clientY),t}catch(o){return null}},window.DOMUtils=function(){},DOMUtils.fill_element=function(e,t){var o="string"==typeof e?$("#"+e)[0]:e;o&&"undefined"!=typeof t&&null!=t&&(o.innerHTML=t)},DOMUtils.remove_element=function(e){var t="string"==typeof e?$("#"+e)[0]:e;t&&t.parentNode&&t.parentNode.removeChild(t)},DOMUtils.set_value=function(e,t){var o="string"==typeof e?$("#"+e)[0]:e;return o&&"undefined"!=typeof o.value?(o.value=t,!0):!1},DOMUtils.get_value=function(e){var t="string"==typeof e?$("#"+e)[0]:e;return t&&"undefined"!=typeof t.value?t.value:null},DOMUtils.focus=function(e){var t="string"==typeof e?$("#"+e)[0]:e;"function"==typeof t.focus&&t.focus()},trulia.hide_selects_exclusions=["top_nav_account_ul","sort_by_dropdown"],DOMUtils.hide_selects_by_el=function(){return!1},window.findPos=function(e){return e=$("string"==typeof e?"#"+e:e),{x:e.offset.left,y:e.offset.top}},window.scrollToEl=function(e){var t=findPos(e);window.scrollTo(t.x,t.y)},window.keyword_keypress_filter=function(e){var t,o,n;return window.event?t=e.keyCode:e.which&&(t=e.which),o=String.fromCharCode(t),n=/[\/?#&']/,rtn=!n.test(o)},define("site_js/library/trulia.dom",function(){}),trulia.follow_area=function(){function e(e,t,n){l=t.showSuccessPopup,r=e.locationId,$.getJSON(site_root+"_ajax/FollowArea/FollowAreaAjax/follow/",e,function(e){if(e.success===!1){if(e.errors.user_id)trulia.auth.logout();else if(e.following!==!0)return e.implicitly_subscribed?($("#"+e.popup_id).length||$("body").append(e.html),void show_pos_menu(null,e.popup_id)):void show_generic_popup("Error",a)}else $("#follow_loc_btn").addClass("unfollow_loc_btn").removeClass("follow_loc_btn");var t,r,s=$(i+" .top .counter_bubble"),c=38;e.html&&(e.following===!0&&(t=$(i+" .following .user"),r=$(i+" .following .users"),$(i+" .following").show(),t.length>=c?t.filter(":first").detach():0===$(i+" .following .user").length&&($(i+" .no_followers_text").hide(),$("#follow_loc_btn").css("float","right"),$(i+" .top .title_wrapper").show()),r.prepend(e.html)),s.html(parseInt(s.html(),10)+1)),e.followed_module&&$(".followed_locations").replaceWith(e.followed_module),l&&o("follow"),"function"==typeof n&&n(e),u&&e.locationShortName&&e.categoryName&&(u.setContent(_,p),u.show())})}function t(e,t){var o=new trulia.Popup({id:"unfollow_area_popup",width:"410px",close:!0,cache_endpoint:!1,destroy_on_cancel:!0});o.setHeader(e),o.setBody(t),o.show()}function o(e){var t=new trulia.Popup({id:"follow_area_success_popup",width:"410px",close:!0,cache_endpoint:!1,destroy_on_cancel:!0});t.setHeader("Following this area"),t.setBody("You are "+("follow"==e?"now":"no longer")+" following updates for this area."),t.show()}var n={},i="#follow_location_module",a="Oops, we ran into a problem.  Please try again at a later time.",r=null,s=!1,l,u=null,c="",d="",_="",p="";return n.follow=function(t,o,n,i){var a;n=$.extend({showSuccessPopup:!0,followOnly:!1},n),"function"==typeof i&&(a=i),require(["authentication/auth_main"],function(i){i.setHeader("Sign in or register<br>to stay up to date"),i.setTrackingContext({flowName:"global_follow_area_topic"}),i.login().done(function(){var i={location_id:t,category_id:o,follow_only:n.followOnly};e(i,n,a)})})},n.unfollow=function(e,n,l,d,_){d=$.extend({confirmUnfollow:0},d),"function"==typeof _&&(s=_),l="boolean"==typeof l?l:!0,r=e,$.get(site_root+"_ajax/FollowArea/FollowAreaAjax/unfollow/",{location_id:e,category_id:n,confirm_unfollow:d.confirmUnfollow},function(e){if(e.success===!1){if(!e.errors.user_id)return void show_generic_popup("Error",a);trulia.auth.logout()}if(e.unfollow_warning)return void t(e.popup.title,e.popup.body);var n=$(i+" .top .counter_bubble"),r;e.user_id&&($(i+' .following .user[data-user-id="'+e.user_id+'"]').detach(),$("#follow_loc_btn").addClass("follow_loc_btn").removeClass("unfollow_loc_btn"),n.html(parseInt(n.html(),10)-1)),r=$(i+" .following .user"),0===r.length&&($(i+" .top .title_wrapper").hide(),$("#follow_loc_btn").css("float","left"),$(i+" .no_followers_text").show()),0===r.length&&$(i+" .following").hide(),l&&o("unfollow"),"function"==typeof s&&s(),e.followed_module&&$(".followed_locations").replaceWith(e.followed_module),u.setContent(c,"")},"json")},n.setupButton=function(e,t,o,n,i,a){$(e).removeAttr("onclick"),$(e).click(function(e){var r=$(this),s=r.find("a");doNothing(e),0===s.attr("title").indexOf(t)?trulia.follow_area.follow(r.data("locationId"),r.data("categoryId"),{showSuccessPopup:!1,locationName:o,category:n},function(){"function"==typeof i&&i(),o_track_ql_click("FollowersModule|Follow")}):trulia.follow_area.unfollow(r.data("locationId"),r.data("categoryId"),!1,{confirmUnfollow:r.data("confirmUnfollow")},function(){"function"==typeof a&&a(),o_track_ql_click("FollowersModule|UnFollow")})})},n}(),define("trulia.follow_area",function(){}),trulia.FollowQuestion=function(){function e(e){e=e[0],show_generic_popup("Thank you","You are now following"+(e.follow_question.checked?" this question":"")+(e.follow_area&&e.follow_area.checked?(e.follow_question.checked?" and":"")+" this area":""))}var t={};return t.wat=function(e,t,o,n){-1!=$(e).html().indexOf("Unfollow")?trulia.FollowQuestion.unfollow(t,e):trulia.FollowQuestion.showFollowPopup(t,o,n)},t.showFollowPopup=function(e,o,n){t.questionId=e,require(["authentication/auth_main"],function(t){t.setHeader("Sign in or register<br>to follow this question"),t.setTrackingContext({flowName:"global_follow_question"}),t.login().done(function(){$.getJSON(site_root+"_ajax/FollowQuestion/FollowQuestionAjax/get_popup/",{question_id:e,location_id:o,location_name:n},function(e){if(e.success===!1)return void show_generic_popup("Error",trulia.errors.DEFAULT_ERROR_MESSAGE);var t=new trulia.Popup({id:"follow_question_popup",width:"400px",close:!0,cache_endpoint:!1,destroy_on_cancel:!0});t.setHeader(e.popup.header),t.setBody(e.popup.body),t.show()})})})},t.unfollow=function(e,o){t.questionId=e,$(o).html("Processing").addClass("disabled_link"),$.getJSON(site_root+"_ajax/FollowQuestion/FollowQuestionAjax/unfollow/",{question_id:trulia.FollowQuestion.questionId},function(e){return e.success===!1?void show_generic_popup("Error",trulia.errors.DEFAULT_ERROR_MESSAGE):void $(o).html("Follow Question").removeClass("disabled_link")})},t.submitPopupForm=function(t){t=t[0],t.follow_question.checked&&$.getJSON(site_root+"_ajax/FollowQuestion/FollowQuestionAjax/follow/",$(t).serialize(),function(e){return e.success===!1?void show_generic_popup("Error",trulia.errors.DEFAULT_ERROR_MESSAGE):void $(".follow_question_cta_"+trulia.FollowQuestion.questionId).html("Unfollow Question")}),t.follow_area&&t.follow_area.checked&&trulia.follow_area.follow(t.location_id.value,null,{showSuccessPopup:!1,followOnly:!0}),t.follow_question.checked||t.follow_area&&t.follow_area.checked?e($(t)):alert("Please check one of the boxes to follow either the question or the area")},t}(),define("trulia.follow_question",function(){}),$(document).ready(function(){if("discussion"==trulia.page_name||"question_answer"==trulia.page_name||"question_details"==trulia.page_name){var e={};$(".answer_comment_form").each(function(t,o){var n=$(o).data("content-type"),i=trulia.voices.setupCommentForm(o,{ajaxEndpoint:"_ajax/QA/AnswerCommentAjax/submit/"});i.setAjaxFormSubmitSuccessCallback(function(t){var i,a;i=$("#"+n+t.contentId+" .comments_label"),a="Comment"==i.html()?0:parseInt(i.html(),10),i.html(1>a?"1 Comment":a+1+" Comments"),$("#"+n+t.contentId+" .comments").prepend(t.html),e[t.contentId]?grecaptcha.reset(e[t.contentId]):grecaptcha.reset(),o.reset()})});var t={},o=40,n=$(".answer_comment_form > .right");$(".qa_answer_content .comments_label").click(function(e){var t=$(e.target).closest(".qa_answer_content").find(".comments_wrapper");"none"==t.css("display")?t.show():t.hide()}),window.location.hash&&-1!==window.location.hash.indexOf("#r")&&$(window.location.hash).closest(".qa_answer_content").find(".comments_label").click(),$("#question_details .flag").click(function(e){var t=$(e.target).closest(".qa_answer_content"),o=t.data("contentid"),n=t.data("content-type");show_flag_menu(e,n,o,$(e.target)[0])}),$("#question_details .link").click(function(e){var t=$(e.target).closest(".qa_answer_content"),o=t.data("contentid"),n=window.location.href.replace(/#.*$/,"")+"#a"+o,i=$(t).find(".link_row");return i.length?void(i.is(":visible")?($(t).find(".link_row").hide(),$(this).removeClass("grey")):($(t).find(".link_row").show(),$(this).addClass("grey"))):($('<div class="link_row mlm"><span>Link:&nbsp;&nbsp;</span><input style="width: 50%" class="bas box boxBasic backgroundBasic mam" type="text" readonly="readonly" value="'+n+'" /></div>').appendTo($(e.target).closest(".qa_answer_content .row")).find("input").click(function(e){$(e.target).get(0).select()}).get(0).select(),void $(this).addClass("grey"))}),$(".qa_answer_content .comments_wrapper .contributions a").click(function(e){return $(".qa_answer_main .comment.hidden").show(),$(e.target).closest(".contributions").hide(),!1}),n.find(".body").focus(function(n){var i=$(n.target),a=i.closest("form").data("contentid"),r=i.closest("form").find("input[name=suffix]").val(),s="recaptchaWrapper"+r,l=$("#"+s);if(!t[a]){if($(n.target).closest("form").find(".button_wrapper").show(),i.css("height",parseInt(i.css("height"),10)+o+"px"),t[a]=!0,l.is(":visible")||l.show(),l.is(":empty")){var u=grecaptcha.render(s,{sitekey:trulia.globals.RECAPTCHA});e[a]=u}i.closest("form").data("grecaptchaWidgetId",u)}}).keyup(function(e){textCounter($(e.target)[0],null,1e3)}),n.find(".cancel_link").click(function(e){var n=$(e.target).closest("form"),i=n.data("contentid"),a=n.find(".body"),r=a.closest("form").find("input[name=suffix]").val(),s="recaptchaWrapper"+r,l=$("#"+s);l.hide(),n[0].reset(),n.find(".button_wrapper").hide(),a.css("height",parseInt(a.css("height"),10)-o+"px"),t[i]=!1})}}),define("trulia.voices_comments",function(){}),trulia.justPostedOrAsked=function(){function e(e){$.getJSON(site_root+"_ajax/QA/JustPostedOrAskedAjax/get_data/",{},function(t){"function"==typeof e&&e(t)})}var t={};return t.trackEvent=function(){var t,o,n;!window.location.hash||-1==window.location.hash.indexOf("#asked_question")&&-1==window.location.hash.indexOf("#posted_discussion")||(n=-1!==window.location.hash.indexOf("#posted_discussion")?"D":"Q",type_hash="#"+("D"==n?"posted_discussion":"asked_question")+"_",t=window.location.hash.replace(type_hash,""),o=parseInt((new Date).getTime()/1e3,10),120>o-t&&e(function(e){var t=e.sourceId||"nosourceid";o_track_ask_submit_qa_event(e.actionId,t,n,e.categoryId,e.locationId,e.pageName)}))},t}(),define("trulia.just_posted_or_asked",function(){}),window.handle_edit_box=function(e,t,o,n){var i=$("string"==typeof e?"#"+e:e);if(i.length){var a="undefined"!=typeof n&&n===!0?"disabled_txt_vivid":"disabled_txt",r=trim(i.val()).toLowerCase();r==CONST.PLACEHOLDER_CITY_STATE_ZIP.toLowerCase()?t=CONST.PLACEHOLDER_CITY_STATE_ZIP:r==CONST.PLACEHOLDER_CITY_STATE_ZIP_ADDRESS.toLowerCase()?t=CONST.PLACEHOLDER_CITY_STATE_ZIP_ADDRESS:r==CONST.PLACEHOLDER_CITY_COUNTY_STATE.toLowerCase()&&(t=CONST.PLACEHOLDER_CITY_COUNTY_STATE);var s=t.toLowerCase();return r!==s&&""!==r?(i.css("color","#000"),void i.removeClass(a)):!o||r!==s&&""!==r?o?void 0:void(r===s||""===r?(i.css("color","#999"),i.addClass(a),i.val(t)):(i.css("color","#000"),i.removeClass(a))):(i.css("color","#000"),i.removeClass(a),void i.val(""))}},window.textCounter=function(e,t,o){return e.value.length>o?(e.value=e.value.substring(0,o),!1):(t&&$("#"+t).html(o-e.value.length),!0)},window.clear_form=function(e){if(e="string"==typeof e?$("#"+e)[0]:e,!e)return!1;for(var t,o=0;o<e.elements.length;++o)t=e.elements[o].type,("text"==t||"password"==t)&&(e.elements[o].value="")},window.get_radio_value=function(e){for(var t=null,o=0;o<e.length;++o)if(e[o].checked){t=e[o].value;break}return t},window.resetif=function(e,t,o){var n=$("#"+e)[0];!n||n.value!=o&&""!==trim(n.value)||(n.value=t)},window.clearif=function(e,t){var o=$("#"+e)[0];o&&o.value==t&&(o.value="")};var buildFormView=function(e,t,o){function n(e){var t=e.replace(/[-_]/g," ").split(" "),n="";return o.each(t,function(e,t){n+=e.charAt(0).toUpperCase()+e.slice(1)}),n}t.views=t.views||{},t.forms=t.forms||{},t.forms.validators=t.forms.validators||{},t.forms.validators.required=function(e){return e.length<=0?!1:!0},t.forms.validators.email=function(e){return is_valid_email(e)},t.forms.validators.phone=function(e){return is_valid_phone(e,!1)};var i={};t.views.FormView=Backbone.View.extend({validators:{},_states:["initial","clean","dirty"],state:"initial",initialize:function(e){var t=this;this.bind("field-error",function(e,o){t.addError(e,o)})},validate:function(n){var i=this,a,a,r;return r="undefined"!=typeof n?[n]:this.getFields(),o.each(r,function(n){n=e(n),a=i.validators[n.attr("name")],a&&o.all(a,function(a){if("function"==typeof a){if(!a.call(i,e.trim(n.val())))return!1}else if(o.has(t.forms.validators,a)&&!t.forms.validators[a].call(i,e.trim(n.val())))return i.trigger("field-error",n.attr("name"),a),!1;return!0})}),this.hasErrors()?(this.state="error",!1):!0},isValid:function(){return!0},getFields:function(){return this.$el.find("input, textarea")},hasErrors:function(){return o.size(this.getErrors())>0?!0:!1},getErrors:function(){return i},addError:function(e,t){o.has(i,e)||(i[e]=[]),o.indexOf(i[e],t)<0&&i[e].push(t)},clearErrors:function(e,t){delete i[e],this.state=this.hasErrors()?"error":"initial",this.render()},clearAllErrors:function(){i={}},getCleanedData:function(){return this.$el.serializeArray()}})};buildFormView(jQuery,trulia,_),define("site_js/library/trulia.forms",function(){}),ContentRatingWidget.prototype.set_count=function(e,t){var o=$(this.el).parent().find(".vote_count").first();this.widget_data.count=e,this.is_up_down?(o.html(trulia.util.pluralize(e,"vote")),this.previous_vote=t):(this.expanded||this.expand(),o.html(e))},ContentRatingWidget.prototype.vote=function(e,t){var o=site_root+"q_vote.php",n=this,i={vt:e,ct:n.widget_data.type,cid:n.widget_data.id};$.post(o,i,function(o){var a="vote_unknown";switch(i.ct){case"r":a="vote_review";break;case"b":a="vote_blog";break;case"d":a="vote_discussion";break;case"g":a="vote_guide";break;case"q":a="vote_question";break;case"a":a="vote_answer";break;case"c":a="vote_comment"}switch(parseInt(o.status)){case trulia.globals.AJAX_STATUS_SUCCESS:o.data.stats&&n.set_count(parseInt(o.data.stats[trulia.globals.voices.VOTE_USEFUL],10)-(o.data.stats[trulia.globals.voices.VOTE_NOT_USEFUL]?parseInt(o.data.stats[trulia.globals.voices.VOTE_NOT_USEFUL],10):0),e);break;case trulia.globals.AJAX_STATUS_FAILURE:show_generic_popup("Oops",trulia.errors.DEFAULT_ERROR_MESSAGE);break;case trulia.errors.AUTH_MUST_LOG_IN:require(["authentication/auth_main"],function(o){o.setHeader("Sign in or register<br>to vote for your favorite answer"),o.setTrackingContext({flowName:"vote_answer"}),o.login().done(function(){n.vote(e,function(e){"function"==typeof t&&t(e),window.location.reload()})})});break;case trulia.errors.voices.CANNOT_VOTE_FOR_SELF:show_generic_popup("Really?","You may not vote for your own content!")}"function"==typeof t&&t(o)})},ContentRatingWidget.prototype.expand=function(){this.expanded||this.el.className.match(/content_rating_widget_voted/)||(this.el.className=this.el.className.replace(/\bcontent_rating_widget(_voted|_voted_hover|_hover|)\b/,"content_rating_widget_voted"),this.el.innerHTML='<span class="vote_count">'+this.widget_data.count+"</span>",this.expanded=!0)},$(document).ready(function(){for(var e=$(".content_rating_widget").toArray(),t=0;t<e.length;t++)new ContentRatingWidget(e[t])}),define("library/trulia.content_rating_widget",function(){}),trulia.share=trulia.share||{},trulia.delete_clr_email=function(e,t){$.ajax({url:site_root+"_ajax/Contacts/ClientListingReportEdit/delete_clr_email/",type:"POST",data:{contact_email:e,property_id:t}})},define("deprecated/trulia.send_to_friend",function(){}),define("application/coreg/trulia.coreg",[],function(){(function(){trulia.namespace("trulia.pdp.views"),trulia.pdp.views.coMarketingView=Backbone.View.extend({el:".quick_connect_container"},{drawComarketingForm:function(e){e&&(trulia.pdp.views.coMarketingViewView.coMarketingDisclaimer=e.disclaimer)},drawForm:function(e){e&&($(".quick_connect_container").each(function(t,o){$(this).get(0).innerHTML=e[t]}),$("#property_bar button").data("quick-connect",!0))}}),trulia.pdp.views.optInView=Backbone.View.extend({leadEndPoint:site_root+"_service/TruliaCoreg/lead",state:{opted:!1},isOpted:function(){return this.$(".coreg_opt_in").is(":checked")},leadType:"QC",initialize:function(e){var t=e.coreg_get_response,o=_.map(t.hidden_fields,function(e,t){return $('<input type="hidden"></input>').attr("name",t).attr("value",e)});o.push($('<input type="hidden"></input>').attr("name","product_class").attr("value",t.product_class)),o.push($('<input type="hidden"></input>').attr("name","platform").attr("value","web")),o.push($('<input type="hidden"></input>').attr("name","user_id").attr("value",t.user_id)),o.push($('<input type="hidden"></input>').attr("name","lifetime_session_id").attr("value",t.lifetime_session_id)),$.fn.prepend.apply(this.$el.find(".coreg_container"),o),this.$(".coreg_container label span").html(t.text),this.$(".coreg_disclaimer").html(t.disclaimer),this.$(".coreg_container input.coreg_opt_in:checkbox").prop("checked",!!t.checked),this.$(".coreg_outer_container, .coreg_container").removeClass("hideFully").show(),$(document).trigger("coreg.loaded")},events:function(){var e=_.bind(this.handleQuickConnect,this);trulia.pubsub.on("quickConnect.formSubmitted",e);var t=_.bind(this.handleNonQuickConnect,this);return trulia.pubsub.on("contactForm.formSubmitted",t),{"click .coreg_opt_in":"handleCheckbox","click [name^=agent_match_selected]:checkbox":"handleQuickConnectCheckbox"}},getCheckedComarketers:function(){return this.$("[name^=agent_match_selected]:checkbox:checked").filter(function(e,t){return!!$(t).data("lender")})},getRandomLender:function(){var e=this.$("[name^=agent_match_selected]:checkbox:checked").map(function(e,t){return $(t).data("lender")});return e[Math.floor(Math.random()*e.length)]},getDisclaimer:function(){return this.isComarketing()?this.options.comarketing_get_response.disclaimer:this.hasPostLead()?"":this.options.coreg_get_response.disclaimer},isComarketing:function(){return this.options.comarketing_get_response&&(this.getCheckedComarketers().length||$("#lender_id").val())},hasPostLead:function(){var e=this.$("[name=product_class]").val();return"CoregMortgageProduct"==e},setVendor:function(){this.lender=this.getRandomLender(),this.isComarketing()?(this.lender=$("#lender_id").val()||this.lender,this.$("[name=lender]").remove(),this.$("[name=vendor]").val(this.options.comarketing_get_response.hidden_fields.vendor),this.$("[name=product_class]").val(this.options.comarketing_get_response.hidden_fields.product_class),$('<input type="hidden" name="lender" value="'+this.lender+'" />').insertAfter(this.$("[name=vendor]"))):(this.$("[name=vendor]").val(this.options.coreg_get_response.hidden_fields.vendor),this.$("[name=product_class]").val(this.options.coreg_get_response.product_class),this.$("[name=lender]").remove())},handleQuickConnectCheckbox:function(e){var t=$(e.targetElement);this.render()},handleCheckbox:function e(t){var o=0===this.$(".coreg_opt_in.fs").length;o_track_quick_connect_lender_checkbox_click(o,this.isComarketing(),this.isOpted()),this.render()},render:function t(){this.isOpted()?(this.$(".contactMessage").removeClass("hideFully"),this.$(".coreg_disclaimer").removeClass("hideFully")):(this.$(".contactMessage").addClass("hideFully"),this.$(".coreg_disclaimer").addClass("hideFully")),this.$(".coreg_disclaimer").html(this.getDisclaimer()),this.setVendor(),this.$el.trigger("coregHasLoaded")},handleFormSubmit:function o(e){if(e.form===this.$el.get(0)){if(this.isOpted()&&!this.hasPostLead()){var t=$(e.form).serializeArray(),o=this.pluckData(t);this.sendLead(o)}if(("CoregMortgageProduct"==$(e.form).find("[name=product_class]").val()||"CoMarketingProduct"==$(e.form).find("[name=product_class]").val())&&"undefined"!=typeof mortgage_coreg_short_form_on&&mortgage_coreg_short_form_on){var n=this.options.coreg_get_response,i=this.options.coreg_get_request,a=this.options.comarketing_get_response,r=new $.Deferred;a&&this.lender?(n=a,r=$.get(site_root+"_ajax/User/UserProfile/get_profile/?profile_type=private&user_id="+this.lender)):r.reject();var s=this;trulia.pdp.views.optInView.sendAgentEmailSuccessCallback=function(t){o_track_quick_connect_lender_submit(s.isComarketing(),s.isOpted()),$.when(r).always(function(o){trulia.pubsub.publish("mortgage.longform.load:pdp",{parent_form:e.form,api_host:_z_api_host,coreg_get_response:n,coreg_get_request:i,lender_values:o,on_close:t,postlead_variations:[]})})}}}},handleQuickConnect:function n(e){this.leadType="QC",this.handleFormSubmit(e)},handleNonQuickConnect:function i(e){this.leadType="FS",this.handleFormSubmit(e)},pluckData:function a(e){var t={};return $.each(e,function(e,o){t[o.name]=o.value}),t},sendLead:function r(e){this.sendLead=function(){};var t=$.post(this.leadEndPoint,e)}},{getRequestParams:function(e){if(!(e&&e.id&&e.stateCode&&e.status))return!1;var t=parseInt(getCookie("uid"),10)||0,o=getCookie("tlftmusr")||"";if(!t&&!o)return!1;var n=["longform"];return{property_id:e.id,property_state:e.stateCode,search_type:e.searchType?e.searchType:e.status.toLowerCase(),platform:"www",user_id:t,lifetime_session_id:o,supported_modules:n,is_builder_community:!!e.isBuilderCommunity}},getForm:function(){var e={};return function(t){if(t&&"for rent"===t.search_type)return null;if(e[t.property_id])return e[t.property_id];var o=$.ajax({type:"GET",url:site_root+"_service/TruliaCoreg/form",dataType:"json",data:t});return e[t.property_id]=o,o}}(),drawForm:function(e,t,o,n){if(this.trackForm(e,t,o,n),e&&!$.isEmptyObject(e)&&e.product_class){var i=$(o).is(".quick_connect"),a="CoregMortgageProduct"==e.product_class;i&&a&&mortgage_coreg_qc_off||$(o).each(function(o,i){var a=new trulia.pdp.views.optInView({el:$(i),coreg_get_response:e,coreg_get_request:t,comarketing_get_response:n});a.render()})}},trackForm:function(e,t,o,n){var i=$("[name^=agent_match_selected]:checkbox:checked").filter(function(e,t){return!!$(t).data("lender")}),a="object"==$.type(e)&&!$.isEmptyObject(e)&&(i.length||$("#lender_id").val()),r=!a&&"object"==$.type(e)&&!$.isEmptyObject(e);
o_track_quick_connect_lender(r,a)},attach_to_contact_form:function(e){var t=$(e),o={id:t.find(":hidden[name=property_id]").val(),searchType:trulia.propertyData?trulia.propertyData.get().searchType:null,stateCode:t.find(":hidden[name=state], :hidden[name=state_code]").val(),status:t.find(":hidden[name=property_status]").val(),isBuilderCommunity:"1"===t.find(":hidden[name=builder_community]").val()},n=trulia.pdp.views.optInView.getRequestParams(o),i=trulia.pdp.views.optInView.getForm(n);$.when(i).done(function(e){trulia.pdp.views.optInView.drawForm(e,n,t),$(document).trigger("coreg.rendered");var o=new Backbone.Model(e);trulia.pubsub.publish("adProxy.coreg.loaded",o),trulia.pdp.coreg=trulia.pdp.coreg||{},trulia.pdp.coreg.model=o})}})}).call(this),0===$(".adProxy").length&&$(document).on("popup.content_loaded",function(e,t){function o(){if("contact_agent_form_popup"===t.popup.id||"rental_community_contact_popup"===t.popup.id||"agent_match_popup"===t.popup.id||"rentalCommunityFloorplanPopup"===t.popup.id){var e=document.getElementById(t.popup.id),o=e.getElementsByTagName("form");o.length>0&&trulia.pdp.views.optInView.attach_to_contact_form(o[0])}}t.popup.ajax?t.popup.ajax.complete(function(){o()}):o()})});var PostLeadExperienceHandlers=require("@trulia/rental-post-lead-experience");trulia.rentalResumePostlead=new PostLeadExperienceHandlers.RenterResume($,_,trulia),define("site_js/trulia.rental_resume_postlead",function(){}),define("site_js/trulia.contact_property",["require","application/coreg/trulia.coreg","site_js/trulia.rental_resume_postlead"],function(e){e("application/coreg/trulia.coreg"),e("site_js/trulia.rental_resume_postlead")}),trulia.ContactUserForm=function(){var e={};return e.toggleTextareaLabel=function(e,t){parseInt(e.scrollTop,10)>0?hide(t):unhide(t)},e}(),trulia.ContactUser=function(){var e={},t,o,n,i,a,r,l,u,c,d,p,h,f="Sorry - an error occurred while sending your email.",m=12367;e.trackContactButton=!0,e.trackingWithData=["requestShowingButton","writeMessageButton","contactSaleOfficeFromDescription"],e.customPostSendAgentEmailCallback=null,e.leadFormErrors=[];var g=function(e,t,o){var n=e?"one click enabled":"one click disabled",i="rental resume not available";return t&&o?i="rental resume attached":t&&(i="rental resume not attached"),"lead:structured|"+n+";lead:structured|expanded state;lead:structured|"+i};return e.initialize_lead_form=function(t){e.rentalResumeCheckboxVisible()&&$("[data-role=one_click_checkbox_container]").addClass("hideFully"),t.find(".twilio_about_icon").click(function(e){trulia.show_static_popup("twilio_about_your_phone","This is your unique Trulia number")}),t.find("#prof_bcard_main").delegate(".twilio_about_icon","click",function(e){trulia.show_static_popup("twilio_about_your_phone","This is your unique Trulia number")}),t.find("form.lead_form").each(function(){var e=$(this);"pro_vertical_contact_form"==e.attr("id")&&e.find(".msg").scroll(function(t){trulia.ContactUserForm.toggleTextareaLabel($(t.target)[0],"msg_label"+e.data("suffix"))})}),t.find("select.lead-subject").on("change",function(e){var t=$(e.currentTarget).val();2==t?$(e.currentTarget).parent().find(".schedule-viewing-msg").show():$(e.currentTarget).parent().find(".schedule-viewing-msg").hide()}),t.find("form .errorContact .boxClose").on("click",function(e){e.preventDefault()}),$("body").on("click",".open_lead_form input[type=text], .open_lead_form textarea, #rental_contact_user_popup_form input[type=text], #rental_contact_user_popup_form textarea, #contact_user_popup_form input[type=text],#contact_user_popup_form textarea",function(e){var t=$(e.currentTarget).parents("form:first").get(0),o=t.lead_track?t.lead_track.value:"unknown";trulia.photoPlayerModal&&"undefined"!=typeof trulia.photoPlayerModal.moduleName?o_track_lead_form_interaction("LeadForm_"+trulia.photoPlayerModal.moduleName,e.currentTarget.name+"_focus"):o_track_lead_form_interaction("LeadForm_"+o,e.currentTarget.name+"_focus")}),$(".show_contact_details").click(function(e){e.preventDefault(),$("#rentalPdpContactLeadForm").removeClass("oneClickLeadFormContactBottom"),$(".rental_one_click_lead_form_container").addClass("hideFully"),$(".rental_open_lead_form_container").removeClass("hideFully")}),$(".boxClose").click(function(e){e.preventDefault(),$(this).closest(".box").fadeOut("slow")})},e.showContactUserPopup=function(t,o,i,a,r){if(!t)return e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n),!1;var s=$.extend({user_id:t,lead_value:o,from_where:trulia.page_name},"undefined"!=typeof r?r:{});$.getJSON(site_root+"q_contact_user_form.php",s,function(t){switch(t.status){case 1:if(!t.popup)return void e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n);var o=new trulia.Popup($.extend({id:"user_contact_popup",classname:"user_contact_popup",width:"350px",close:!0,cache_endpoint:!1},a));o.setHeader(i||t.popup.header),o.setBody(t.popup.body),o.show();break;default:e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n)}})},e.trackContactButtonClick=function(t){e.trackContactButton&&o_track_ql_click(t)},e.showContactAgentPopup=function(o,i,a,r,s,l,u){var p=$("#floorplan_flow").data("value");if(t=o.isComplete?o:trulia.srp&&trulia.srp.PropertyCollection?trulia.srp.PropertyCollection.get(o.id).toJSON():trulia.propertyData.get(o,!0),i=i||trulia.page_name,_.isEmpty(t))return e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n),!1;var h="q_property_contact_user_form.php";t.isRentalCommunity?h="q_show_contact_rental_community_form.php":t.isRental&&(h="q_show_contact_rental_noncommunity_form.php"),$.getJSON(site_root+h,{property_id:t.id,property_hash:t.hash,property_status:t.status,city:t.city,state_code:t.stateCode,location_id:t.locationId,floorplan_id:t.floorplanId,floorplan_data:"undefined"!=typeof o&&"undefined"!=typeof o.popupData?o.popupData:"",from_where:i,is_srp_featured:t.isSrpFeatured,lead_value:a,cta_type:s,user_id:l,checkin_id:u,builder_community:t.isBuilderCommunity===!0?1:0},function(_){var h;switch(_.status){case 1:if(!_.popup)return void e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n);if(!_.popup.body||_.data.missing_contact_info)return trulia.voices.UgcFormPopup.showAskAboutPropertyPopup(trulia.propertyData.get().locationId,53,!0),!1;if("RentalCommunityFloorPlanForm"==o.popupType){var h=o.popupData.childUnitIds?{list1:"unit|view form"}:{list1:"floor plan|view form"};return e.showRentalCommunityFloorPlanPopup(_,h),void trulia.rentalResumePostlead.listenToShareRentalResumeCheckboxChange()}var f=t.isRentalCommunity?"rental_community_contact_popup":"contact_agent_form_popup",m=t.isRentalCommunity?"community_contact":t.isRental?"rental_contact":"user_contact_popup",v={id:f,classname:m,width:e.getPopupWidth(_.data),close:!0,cache_endpoint:!1,zIndex:6006006},w=new trulia.Popup(v);if(_.hide_header||w.setHeader(r||_.popup.header),w.setBody(_.popup.body),!_.auto_submit||p){if("undefined"!=typeof trulia.srp&&t.isRental){var y="single";t.isRentalCommunity&&(y="community"),"function"==typeof trulia.analytics.trackState&&trulia.analytics.trackState({pageDetails:"standalone lead form",listingType:"rental|apartment|"+y,formAttributes:g(!1,d,c)})}w.show(),(t.isRental||t.isRentalCommunity)&&trulia.rentalResumePostlead.listenToShareRentalResumeCheckboxChange()}if(trulia.ContactUser.prepareLeadRecommenderBypassElements(),$(".boxClose").click(function(e){e.preventDefault(),$(this).closest(".box").fadeOut("slow")}),$("[data-role=one_click_checkbox]").each(function(){initOneClickCheckbox($(this))}),trulia.ContactUser.rentalResumeCheckboxVisible()&&$("[data-role=one_click_checkbox_container]").addClass("hideFully"),trulia.ContactUser.customPostSendAgentEmailCallback){var b=trulia.ContactUser.customPostSendAgentEmailCallback;trulia.ContactUser.setCustomPostSendEmailCallback(function(e){w.destroy(),b(e)})}else trulia.ContactUser.setCustomPostSendEmailCallback(function(){w.destroy.bind(w)});if(_.auto_submit&&_.auto_submit_form_id&&!p){var k={popupParams:{fromWhere:i,leadValue:a,headerText:r,ctaType:s,userId:l,checkinId:u},autoSubmit:!0};e.sendEmailToAgent($("#"+_.auto_submit_form_id),k)}break;default:e.addError(trulia.errors.DEFAULT_ERROR_MESSAGE,n)}})},e.getPopupWidth=function(e){return e.is_ask_question_popup?"445px":"checkin"==a?"420px":"350px"},e.attachCommunityFloorPlanPopup=function(t,o,n,i,a,r,s,l,u,c,d){var _=$(o),p=_.closest(n).data("floorplan");"undefined"!=typeof p&&(p.showRentalCommunityPhoneNumber=i.showRentalCommunityPhoneNumber?"1":"0"),_.off(t),_.on(t,function(){return i={id:i.id,stateCode:i.stateCode,status:i.status,locationId:i.locationId,city:i.city,popupType:"undefined"!=typeof p?"RentalCommunityFloorPlanForm":"",popupData:p},e.showContactAgentPopup(i,a,r,s,l,u,c),"undefined"!=typeof d&&d(),!1})},e.checkRequiredData=function(t,o,i,a,s,l,u,c,d){var p=!1,h=e.isPhoneValid(u,t.isRental),f=t.isRental;r&&(c=!0),c||!_.isEmpty(t)&&(o||t.hash||t.isRental)||(p=!0,e.addError("Please select a property to contact.",n)),t.isRental?/^([a-zA-Z0-9\s]{2,})$/.test(i)||(p=!0,e.addError("Your name should be at least 2 letters. Please exclude special characters.",n,"user name")):i||(p=!0,e.addError("Please enter your name.",n,"user name")),a&&is_valid_email(a)||(p=!0,e.addError("Please enter a valid email address, such as name@example.com.",n,"user email")),s||(p=!0,e.addError("Please enter a message.",n,"user message"));var m=/(http\:\/\/|https\:\/\/)([a-z0-9][a-z0-9\-]*\.)+[a-z0-9][a-z0-9\-]*/gi,g=/([a-z0-9#=@][a-z0-9\-@]*\.)+(com|org|net|int|edu|gov|mil)\b/gi,v=s.match(g);if(s.match(m))p=!0,e.addError("Please remove links from the message.",n,"user message");else if(v)for(var w in v){if(is_valid_email(v[w])){p=!0,e.addError("Please remove email address from the message.",n,"user message");break}p=!0,e.addError("Please remove links from the message.",n,"user message");break}return h||(l||u)&&(p=!0,e.addError("Please enter a valid phone number.",n,"user phone")),-1!==d&&""===d&&(p=!0,e.addError("Please select residents and income range option.",n,"income range dropdown")),p===!0?(f&&(o_track_lead_form_errors(e.leadFormErrors),e.leadFormErrors=[]),e.sendEmailToAgentReturnAction(!1)):!0},e.isPhoneValid=function(e,t){if(t){var o=/^[\s]*1?[- .]?\(?(?!555)[2-9]\d{2}\)?[- .]?(?!(555))([2-9](?!11)\d{2})[- .]?\d{4}([^\d]+.*)?$/;return is_valid_phone(e)&&o.test(e)}return is_valid_phone(e)},e.initPropertyDataArrayAndPropertyData=function(n,i,a){_.isEmpty(t)?e.initPropertyDataArray(n,i,a):(o=[],o.push(t))},e.initPropertyDataArray=function(e,n,i){o=[];for(var a=e.length,r=0;a>r;r++)o.push(trulia.propertyData.get({id:e[r],status:n,stateCode:i[r]}));t=o[0]},e.resetToDefaultValue=function(){t={},o=[],e.clearErrors(n)},e.canWeUseOpenFrom=function(t){var o=t.data("open-from");return-1===$.inArray(o,e.trackingWithData)?!1:!0},e.sendMovingQuoteDataToQueue=function(t,o,n){var i=$(t);e.clearErrors(i);for(var a=function(e){if("hidden"===e.type)return!0;var t;if(t="string"==e.type?i.find("input[name="+e.name+"]").val():i.find("select[name="+e.name+"]").val(),e.required&&!t)return!1;var o=new RegExp(e.validation);if(!o.test(t))return!1;if(e.min)if("date"==e.data_type){var n=new Date(e.min),a=new Date(t);if(n>a)return!1}else if(t<e.min)return!1;if(e.max)if("date"==e.data_type){var r=new Date(e.max),a=new Date(t);if(a>r)return!1}else if(t>e.max)return!1;return!0},r=0;r<n.length;r++){var s=a(n[r]);if(!s)return e.addError(n[r].errorMessage,i),!1}"undefined"==typeof o&&(o={}),o=$.extend({movingSuccessCallback:function(){},omnitureTrack:!0},o);var l=i.id,u=i.find("input[name=phone]").length?i.find("input[name=phone]").val():"",c=i.find("input[name=moveDate]").length?i.find("input[name=moveDate]").val():"",d=i.find("input[name=fromZip]").length?i.find("input[name=fromZip]").val():"",_=i.serialize()+"&sourceUrl="+encodeURIComponent(window.location.href);o.omnitureTrack&&o_track_ql_click("MovingLeadForm|submit"),i.find(".getQuote").hide(),i.find(".getQuoteLoader").show(),$.getJSON(site_root+"_ajax/Leads/RentalsMovingServicesLead/send_lead/",_,function(e){i.find(".getQuoteLoader").hide(),i.find(".getQuote").show(),$("#movingServicesQuoteForm .errorContact p.error").html(e.message),e.success?(o.movingSuccessCallback(),$("#movingServicesPopupForm").trigger("submit")):$("#movingServicesQuoteForm .errorContact").show()}).success(function(){var t=i.find("input[name=moveDate]").prop("defaultValue"),o=i.find("input[name=phone]").prop("defaultValue"),n=i.find("input[name=fromZip]").prop("defaultValue");(o!=u||t!=c||n!=d)&&e.updateUserProfile(void 0,u,c,d)})},e.getMovingToZipForMovingServices=function(e){var t=null;if("undefined"!=typeof trulia.propertyData){var o=trulia.propertyData.get();"undefined"!=typeof o.zipCode&&(t=o.zipCode)}if(null===t&&"undefined"!=typeof trulia.srp&&"undefined"!=typeof trulia.srp.PropertyCollection&&trulia.srp.PropertyCollection.length>0){var o=trulia.srp.PropertyCollection.get(e.find("input[name=property_id]").val()).toJSON();"undefined"!=typeof o.zipCode&&(t=o.zipCode)}return null===t&&(t=e.find("input[name=moving_to_zip]").val()),null===t&&(t="94103"),t},e.updateUserProfile=function(e,t,o,n){var i=Backbone.Model.extend({urlRoot:site_root+"account/user_profile/save-lead-form-data",validate:function(e,t){return void 0===e.name&&this.unset("name"),void 0===e.phone&&this.unset("phone"),void 0===e.moveDate&&this.unset("moveDate"),void 0===e.fromZip&&this.unset("fromZip"),void 0===e.name&&void 0===e.phone&&void 0===e.moveDate&&void 0===e.fromZip?"error: no attribute set":void 0}}),a=new i;a.set({name:e}),a.set({phone:t}),a.set({moveDate:o}),a.set({fromZip:n}),a.save()},e.getClickTrackingMap=function(){return{pro_vertical_contact_form:"ProOpenContact",details_open_contact_form:"OpenContactForm",details_rental_open_contact_form:"RentalOpenContactForm",contact_user_popup_form:"PopupContactForm",contact_user_popup_form_photoplayer_popup:"PopupContactForm|PhotoPlayerPopup",rental_contact_user_popup_form:"RentalPopupContactForm",rental_community_open_contact_form:"RentalCommunityOpenContactForm",rental_community_vertical_contact_form:"RentalCommunityContactForm",rental_community_contact_popup_form:"RentalCommunityPopupForm",profile_open_contact_form:"ContactOpenForm|ContactMe_Button",voices_contact_popup_form:"VoicesPopupContactForm",dossier_send_message_form:"Profiles3ContactForm",requestShowingButton:"RequestShowingForm",writeMessageButton:"WriteMessageButtonForm",contactSaleOfficeFromDescription:"ContactSaleOfficeFromDescriptionForm",plan_modal:"PlanModalContactForm"}},e.preparePopupParams=function(e){return e=e||{},_.defaults(e,{fromWhere:"",leadValue:"",headerText:"",ctaType:"",userId:"",checkinId:""})},e.sendEmailToAgent=function(l,m){var g=m||{};if(!this.isSubmitButtonDisabled($(l))){var v=l.serialize(),w,y=this;v===u&&close_all_menus(),n=l[0],w=$(n),i=w.find("input[name=contact_who]").length?w.find("input[name=contact_who]").val():"agent",a=w.find("input[name=from_where]").length?w.find("input[name=from_where]").val():"",r=w.find("input[name=is_user_contact]").length?w.find("input[name=is_user_contact]").val():!1;var b=w.find("input[name=property_id]").length?w.find("input[name=property_id]").val():"",k=w.find("input[name=property_ids]").length?w.find("input[name=property_ids]").val():"",C=w.find("input[name=property_status]").length?w.find("input[name=property_status]").val():"",S=w.find("input[name=state_code]").length?w.find("input[name=state_code]").val():"",E=w.find("input[name=state_codes]").length?w.find("input[name=state_codes]").val():"",T=w.find("input[name=user_id]").length?w.find("input[name=user_id]").val():"",R=w.find("input[name=name]").length?w.find("input[name=name]").val():"",P=w.find("input[name=email]").length?w.find("input[name=email]").val():"",x=w.find("textarea[name=msg]").length?w.find("textarea[name=msg]").val():"",A=parseInt(w.find("input[name=phone_required_flag]").length?w.find("input[name=phone_required_flag]").val():0,10),M=w.find("input[name=community_move_in_date_optional]").length?w.find("input[name=community_move_in_date_optional]").val():0,L=w.find("input[name=phone]").length?w.find("input[name=phone]").val():"",F=w.find("input[name=site_name]").length?w.find("input[name=site_name]").val():"",I=w.find("input[name=agent_new_contact_frm]").length?w.find("input[name=agent_new_contact_frm]").val():"",q=w.find("select[name=rental_income_restricted_select]").length?w.find("select[name=rental_income_restricted_select]").val():-1,O,D=$("#"+n.id+" .response"),N,U,H=n.id;L=L.replace(/[\(\)\.\-\A-Z\a-z\ ]/g,""),w.find("input[name=phone]").val(L),""===x&&(x=w.find("input[name=msg]").length?w.find("input[name=msg]").val():""),D.hide(),D.html(""),e.clearErrors(n),getLeadFormType(w),""===k?(k=[],k.push(b)):k=k.split(","),""===E?(E=[],E.push(S)):E=E.split(",");var B=w.find("[name=addl-msg]").val();void 0!==B&&B.length>0&&(w.find("[name=msg]").val(B),x=B),e.initPropertyDataArrayAndPropertyData(k,C,E);var j=o.length,V=0,z=!0,Q=!1;for(V=0;j>V;V++){if(V>0&&(Q=!0),z=e.checkRequiredData(o[V],T,R,P,x,A,L,Q,q),z===!1&&g.autoSubmit){var W={profile_data:{oneClickSend:0}};return $.post({url:site_root+"_ajax/User/ConsumerDemographicData/save_profile/",dataType:"json",data:W,success:function(){var o=e.preparePopupParams(g.popupParams);trulia.ContactUser.showContactAgentPopup(t,o.fromWhere,o.leadValue,o.headerText,o.ctaType,o.userId,o.checkinId)}}),!1}if(z===!1)return!1}var G=function(o){var a=o||{};trulia.pubsub.trigger("contactForm.formSubmitted",{form:n}),N="_ajax/Leads/Lead/email_lead/";var l=-1!==window.location.href.indexOf("?")?window.location.href.split("?")[1]:"";-1!==l.indexOf("qaov")&&(N=N+"?"+l),U=w.serialize()+"&page_location_url="+encodeURIComponent(window.location.href)+"&s=1",y.showSendingRequestSpinner(w),y.disableSubmitButton(w.find("input[type=submit]")),$.getJSON(site_root+N,U,function(o){var l,m=void 0!==s&&void 0!==s.pageName?s.pageName:"",g=t.status==CONST.PROPERTY_STATUS_FOR_RENT?CONST.USER_STATUS_RENTER:CONST.USER_STATUS_BUYER,k;k=w.find('input[name="lead_track"]').val(),k=k&&k.match(/^(FloatingRightRailForm|BottomToasterFormFL|BottomToasterFormQC|BottomToasterForm|PhotoPlayerEmbedded)/)?"|"+k:null,e.sendEmailToAgentReturnAction(),e.submitEventOnFormSubmit(w.serializeArray(),o);var C=trulia.photoPlayerModal&&trulia.photoPlayerModal.moduleName||"other";switch(o.status){case 1:if("login_autoreg_user"===o.postCallAction&&trulia.auth.postLogin("register",o.data.user_id),!_supports_my_trulia||r)if(1==I)switch(H){case"dossier_send_message_form":$("#email_success").modal("open");break;default:$("#contactPopup .contactAgentFormContent").hide(),$("#contactPopup .contactAgentSuccess").removeClass("hideVisually")}else t.isRental||(t.isRental&&e.showMovingPostLeadSequence(o)?e.showRentalPostLeadMovingServicesForm(o,function(){show_generic_popup("Success!","Thank you, your message has been sent.")}):show_generic_popup("Success!","Thank you, your email has been sent to the "+i+"."));if(t.isRental){p=e.isOneClickChecked(),h=e.isOneClickVisible(),e.isRentalResumePostLeadEnabled()&&(d=e.rentalResumeCheckboxVisible(),d&&(c=e.rentalResumeCheckboxChecked()));var S=d&&c,E=h&&p,T={oneClickEnabled:E,rentResumeSent:S};trulia.ContactUser.customPostSendAgentEmailCallback?(E&&$(".cardContainer .cardFooter button").text("Request Info with 1-Click"),trulia.ContactUser.customPostSendAgentEmailCallback(o)):trulia.ContactUser.setCustomPostSendEmailCallback();var R=require("@trulia/rental-post-lead-experience"),x=new R.ComboExperience($,trulia,o_track_ql_click,_),A=new R.RentalScheduling($,trulia),M=new R.RenterResume($,_,trulia),L=new R.PropertyRecommender($,trulia,o_track_ql_click),F;F=S?"Message sent with Rental Resume!":E?"Message sent with 1-Click!":"Thank you, your message has been sent.",x.hasPostLeadExperienceData(o)?x.showPostLeadExperiences(o,T,function(){show_generic_popup("Success!",F)}):M.hasPostLeadRentalResumeData(o)?M.showRentalResumeForm(o):L.showRecommendedPropertiesPostLeadSequence(o)?L.showRecommendedPropertiesModal(o):A.hasPostLeadSchedulingData(o)?A.showRentalSchedulingForm(o):show_generic_popup("Success!",F)}if("login_autoreg_user"===o.postCallAction){o_track_register_event(C,g+"|"),trulia.tracking.authFlowTracking.trackEvent(trulia.tracking.authFlowTracking.EVENT_TYPE_REGISTER_ATTEMPT,H,!1,k),trulia.tracking.authFlowTracking.trackEvent(trulia.tracking.authFlowTracking.EVENT_TYPE_REGISTER_SUCCESS,H,null,k),t.isBuilderCommunity||o_track_property_follow(m+"|LeadSubmit|Autosave|NewUser");var q={email:P};e.sendAgentEmailSuccessCallback("register",o,q)}else if("show_login_form"!=o.postCallAction||t.isRental){var q={email:P};(o.followed===!0||o.data&&o.data.followed===!0)&&(o_track_property_follow(m+"|LeadSubmit|Autosave|ExistingUser"),b&&trulia.pubsub.publish("property.saved",{id:o.data.id,status:o.data.status,stateCode:o.data.stateCode,propertyAlreadySaved:o.data.property_already_saved})),e.sendAgentEmailSuccessCallback(null,o,q)}else{var q={$frm:w,response:o,pageName:m,email:P,moduleTracking:k},O=w.find('input[name="name"]').length?w.find('input[name="name"]').val():null,N=w.find("input[name=phone]").length?w.find("input[name=phone]").val():null,U=function(){e.sendAgentEmailSuccessCallback("login",o,q)},B=function(t){e.loginSuccess(e.sendAgentEmailSuccessCallback,q,t)};_trulia_logged_in||(e.autoRegister(P,O,N),e.sendAgentEmailSuccessCallback("login",o,q))}y.hideSendingRequestSpinner(w),y.setFormAsRequestSent(w),a.disable_all_submit_buttons?$(".send_email_to_agent_button").each(function(){y.disableSubmitButton($(this),"Request Sent")}):y.disableSubmitButton(w.find("input[type=submit],.send_email_to_agent_button"),"Request Sent"),y.disablePopupTriggerSubmitButtons();break;default:var j=o.message||f,V="\n",z,Q;if(D.length)D.html(j),D.show();else if(t.isRental&&e.isOneClickChecked()&&a.popupParams)Q=e.preparePopupParams(a.popupParams),trulia.ContactUser.showContactAgentPopup(t,Q.fromWhere,Q.leadValue,Q.headerText,Q.ctaType,Q.userId,Q.checkinId);else{for(z in o.errors)o.errors.hasOwnProperty(z)&&(V+=o.errors[z]+"\n");e.addError(j+V,n)}y.enableSubmitButton(w.find("input[type=submit],.send_email_to_agent_button"),"Request Info")}"mytrulia"==trulia.page_name&&(_num_friend_emails=1),u=v}).success(function(){var o=w.find('input[name="name"]'),n=w.find('input[name="phone"]'),i=o.prop("defaultValue"),a=n.prop("defaultValue"),r=o.val(),s=n.val(),l;(i!=r||a!=s)&&e.updateUserProfile(r,s),t.isSubsidized&&(l=t.isRentalCommunity?"multi-family|community:subsidized":"single-family home|single_unit:subsidized",o_track_ql_click(l))}).fail(function(){y.enableSubmitButton(w.find("input[type=submit],.send_email_to_agent_button"),"Request Info")})};if("For Sale"==t.status&&x.match(/ rent | rental/i)&&(t.zipCode||t.city&&t.stateCode)){var X=function(){$("#popup_submit").click(function(){e.popup.close(),G()})};e.popup=trulia.ajaxPopup.SimplePopup("for_sale_not_rent_popup","Leads","QuickConnect","Looking for rentals?",X,{zipCode:t.zipCode?t.zipCode:"",city:t.city,stateCode:t.stateCode})}else{var Y,J=w.find("select[name=rental_income_restricted_select]").length?w.find("select[name=rental_income_restricted_select]"):null;J&&"string"==typeof J.val()&&(Y=w.find("textarea[name=msg]"),Y.val(Y.val()+"\n\n"+J.val()),J.val(0)),G(g)}}},e.showRentalCommunityLeadResponsePopup=function(e,o){if(11961===t.feedId&&"undefined"!=typeof e){var n={width:"485px",close:!0,classname:"rentComRewardPopup",id:"rentComRewardPopup",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!1},a=new trulia.Popup(n);a.setHeader(e.data.rental_reward_template_data.header),a.setBody(e.data.rental_reward_template_data.body),a.show(),$("#rentComRewardPopup .moreInfoButton").on("click",function(){o_track_ql_click("RentReward:LearnMore |Clicked")})}else $.getJSON(site_root+"q_show_post_lead_success_popup.php",{property_id:t.id,property_status:t.status,state_code:t.stateCode}).done(function(e){switch(e.status){case 1:destroy_popup("post_lead_success_popup"),destroy_popup("rental_community_contact_popup"),close_all_menus("contact_agent_form_popup"),e.data.popup.popup_consumer_link&&!e.data.popup.profile_complete?displayPostLeadLinkToProfile(e.data.popup.header,e.data.popup.body):show_generic_popup("Success!","Thank you, your email has been sent"+(o?"":" to the "+i));break;default:trulia.ContactUser.addError(trulia.errors.DEFAULT_ERROR_MESSAGE)}}).fail(function(){trulia.ContactUser.addError(trulia.errors.DEFAULT_ERROR_MESSAGE)})},e.skippedMovingServicesForm=function(e){setCookie("skip_moving_services_form",1),o_track_ql_click("MovingLeadForm|"+e)},e.shouldSkipMovingServicesForm=function(){return getCookie("skip_moving_services_form")},e.finishedPostLeadExperience=function(e,t){var o={status:t,experience_name:e};$.ajax({url:site_root+"_ajax/RentalsPostLead/PostLeadExperience/post_lead_experience_finished/",dataType:"json",data:o})},e.showRentalPostLeadMovingServicesForm=function(t,o,n){var i={width:"326px",close:!0,classname:"movingServicesPopupForm",id:"movingServicesPopupForm",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!0},a=new trulia.Popup(i);a.setHeader(t.data.rental_moving_quote_template_data.header),a.setBody(t.data.rental_moving_quote_template_data.body),a.show(),$("#movingServicesPopupForm").on("submit",function(t){e.finishedPostLeadExperience("MOVING_QUOTE","completed"),"function"==typeof o?(o(),destroy_popup("movingServicesPopupForm")):destroy_popup("movingServicesPopupForm")}),o_track_ql_click("MovingLeadForm|loaded"),$(".selectPretty").truliaSelect(),$("#"+i.id+" .datepicker").datepicker({minDate:1}).blur(),void 0!==n&&n.moveInDate&&$("#movingServicesQuoteForm input[name='moveDate']").val(n.moveInDate),$("#movingServicesPopupForm a.container-close").on("click",function(t){o_track_ql_click("MovingLeadForm|skip"),e.finishedPostLeadExperience("MOVING_QUOTE","skipped")})},e.showRentalPropertyRecommenderForm=function(o){var n={width:"720px",close:!0,classname:"rentalPropertyRecommenderModal",id:"rentalPropertyRecommenderModal",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!0},i,a=new trulia.Popup(n);a.setHeader(o.data.rental_moving_quote_template_data.header),a.setBody(o.data.rental_moving_quote_template_data.body),a.show(),$("#rentalPropertyRecommenderModal li.clickable").on("click",function(){i=t.isRentalCommunity?"community":"single",o_track_ql_click("recommended_prop|"+i+"|click"),e.finishedPostLeadExperience("RECOMMENDED_PROPERTIES","completed")}),o_track_ql_click("recommended_prop|load"),$(".selectPretty").truliaSelect(),$("#rentalPropertyRecommenderModal a.container-close").on("click",function(t){o_track_ql_click("recommended_prop|exit"),e.finishedPostLeadExperience("RECOMMENDED_PROPERTIES","skipped")})},e.showRentalPropertyResponsiveRecommenderForm=function(t){var o={width:$(window).width>1400?"992":"600",close:!0,classname:"rentalPropertyRecommenderResponsiveModal",id:"rentalPropertyRecommenderResponsiveModal",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!0},n,i=new trulia.Popup(o);i.setHeader(t.data.rental_moving_quote_template_data.header),i.setBody(t.data.rental_moving_quote_template_data.body),i.show(),$("#recommendedPropertiesNextLink li.clickable").on("click",function(){e.finishedPostLeadExperience("RECOMMENDED_PROPERTIES","completed")}),$(".selectPretty").truliaSelect(),$("#recommendedPropertiesNextLink").on("click",function(t){e.finishedPostLeadExperience("RECOMMENDED_PROPERTIES_RESPONSIVE","skipped"),i.destroy()})},e.showRentalCommunityFloorPlanPopup=function(e,t){trulia.analytics&&trulia.analytics.saveInteractedWith("rent:pdp:overview|floor plans module:request availability link");var o={width:"780px",close:!0,classname:"rentalCommunityFloorplanPopup",id:"rentalCommunityFloorplanPopup",cache_endpoint:!1,use_cancel_link:!0,destroy_on_cancel:!0,fixedcenter:!0,isNewStyle:!0},n=new trulia.Popup(o);n.setHeader(""),n.setBody(e.popup.body);var i=n.show();i&&trulia.analytics&&trulia.analytics.trackState({siteSection:"rent",pageType:"overlay",pageDetails:"floor plans",pageName:"rent:overlay:floor plans",form:"lead:reg rental"}),1===e.is_rental_senior_housing?renderSpecialtyHousing(window.specialtyHousing,"SeniorHousingFormSide"):1===e.is_rental_student_housing&&renderSpecialtyHousing(window.specialtyHousing,"StudentHousingFormSide"),$(".boxClose").click(function(e){e.preventDefault(),$(this).closest(".box").fadeOut("slow")}),o_track_ql_click("RentalCommunityFloorPlanPopup|Loaded",t),this.setCustomPostSendEmailCallback(n.destroy.bind(n))},e.addError=function(t,o,n){var i={};if(i.formField=n,i.errorId="",i.errorMessage=t,e.leadFormErrors[n]=i,!o)return void alert(t);var a=$("#"+o.id+" .errorContact");return 0===a.length&&(a=$(o).attr("id")?$("#"+$(o).attr("id")+" .errorContact"):"",0===a.length)?void alert(t):(a.find("p").append(t+"<br />"),a.removeClass("hideFully"),void a.show())},e.clearErrors=function(e){if(e){var t=$("#"+e.id+" .errorContact");(0!==t.length||(t=$(e).attr("id")?$("#"+$(e).attr("id")+" .errorContact"):"",0!==t.length))&&(t.hide(),t.addClass("hideFully"),t.find("p").html(""))}},e.sendEmailToAgentReturnAction=function(e){return $(n).find(".send_email_to_agent_loader").hide(),$(n).find(".send_email_to_agent_button").show(),"undefined"!=typeof e?e:void 0},e.submitEventOnFormSubmit=function(e,t){var o={formData:e,response:t};$(document).trigger("AfterSubmit.ContactProperty",o)},e.showPostLeadLoginForm=function(o,n,i,a){var r,s=$.extend({email:o},a);t.isRental?(r={id:"save_property_rental",globalHeader:"Your message is on its way"},s.userStatus=CONST.USER_STATUS_RENTER,$(document).one("loggedInDestroy.authPopup",n),$(document).one("notLoggedInDestroy.authPopup",i),trulia.AuthPopup.show(r,s)):e.promptToLogIn(o,n,i)},e.promptToLogIn=function(e,o,n){var i={userStatus:t.isRental?CONST.USER_STATUS_RENTER:CONST.USER_STATUS_BUYER},a={flowName:"contact_user_popup_form"};require(["authentication/auth_main"],function(t){t.setEmail(e).setLoginHeader("Sign in to track the<br>status of this home").setCreatePasswordHeader("Create a password to<br>track the status of this home").setTrackingContext(a),t.completeAutoRegister(i).done(function(e){o(e)}).fail(function(){n()})})},e.autoRegister=function(e,o,n){var i={userStatus:t.isRental?CONST.USER_STATUS_RENTER:CONST.USER_STATUS_BUYER,name:o,phone:n},a={flowName:"contact_user_popup_form"};require(["authentication/auth_main"],function(t){t.setEmail(e).setLoginHeader("Sign in to track the<br>status of this home").setCreatePasswordHeader("Create a password to<br>track the status of this home").setTrackingContext(a),t.autoRegisterWithoutPassword(i)})},e.loginSuccess=function(o,n,i){var a=n.$frm.serialize()+"&page_location_url="+encodeURIComponent(window.location.href),r=i&&i.get("isNewRegistration");$.getJSON(site_root+"_ajax/Leads/Lead/post_lead_sent_and_login/",a,function(i){t.isBuilderCommunity||i.data.followed!==!0||o_track_property_follow(n.pageName+"|LeadSubmit|Autosave|"+(r?"NewUser":"ExistingUser")),e.showMovingPostLeadSequence(n.response)&&(i.data=_.extend({},n.response.data,i.data)),o&&o("login",i,n)})},e.showMovingPostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"movingservices"===e.data.rental_moving_quote_template_data.formfor},e.showRecommendedPropertiesPostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"recommendedproperties"===e.data.rental_moving_quote_template_data.formfor},e.showRecommendedPropertiesResponsivePostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"recommendedpropertiesresponsive"===e.data.rental_moving_quote_template_data.formfor},e.showEmptyPropertiesPostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"empty"===e.data.rental_moving_quote_template_data.formfor
},e.showRentalResumePostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"rentalresume"===e.data.rental_moving_quote_template_data.formfor&&_trulia_logged_in},e.showRentalResumeSentPostLeadSequence=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.data&&"undefined"!=typeof e.data.rental_moving_quote_template_data&&"undefined"!=typeof e.data.rental_moving_quote_template_data.formfor&&"rentalresumesent"===e.data.rental_moving_quote_template_data.formfor&&_trulia_logged_in},e.isRentalResumePostLeadEnabled=function(){return t.isRental},e.isOneClickChecked=function(){return t.isRental&&$("[data-role=one_click_checkbox]").is(":checked")},e.isOneClickVisible=function(){return $("[data-role=one_click_checkbox]").length>0},e.rentalResumeCheckboxVisible=function(){return!$(".rentalResumeAttachOption").hasClass("hideFully")},e.rentalResumeCheckboxChecked=function(){return $("#rental_resume_attached").is(":checked")||$("#rental_resume_attached_popup").is(":checked")},e.setRenterResumeChecked=function(e){$("#rental_resume_attached").prop("checked",e),$("#rental_resume_attached_popup").prop("checked",e),c=e},e.getRenterResumeChecked=function(){return c},e.refreshMovingServicesMoveInDatePostLeadForms=function(e){"undefined"!=typeof e.data.refresh_moving_com_move_in_date&&$(".movingServicesPopupForm").find("input[name=move_date]").val(e.data.refresh_moving_com_move_in_date)},e.showMortgageLongForm=function(){var e=$(n);return trulia.pdp&&trulia.pdp.views&&trulia.pdp.views.optInView&&trulia.pdp.views.optInView.sendAgentEmailSuccessCallback&&("CoregMortgageProduct"==e.find("[name=product_class]").val()||"CoMarketingProduct"==e.find("[name=product_class]").val())},e.setCustomPostSendEmailCallback=function(e){this.customPostSendAgentEmailCallback=e},e.sendAgentEmailSuccessCallback=function(i,a,s){var l=n.lead_track?n.lead_track.value:"",u=n.uid?n.uid.value:a&&a.data&&a.data.user_id?a.data.user_id:"",f=n.is_custom_blog&&"1"===n.is_custom_blog.value?!0:!1,m=n.ss_broker_site_id?n.ss_broker_site_id.value:null,v=n.ss_pro_plan?n.ss_pro_plan.value:null,w=n.ss_featured_type?n.ss_featured_type.value:null,y=$(n).find("[name=coreg_opt_in]").is(":checked"),b=$(n).find("[name=floorplan_unit_bedrooms]").val();(t.id||o&&o.length&&o[0].id)&&(_.defer(function(){trulia.photoPlayerModal&&trulia.photoPlayerModal.moduleName&&(l="PhotoPlayerPopup");var e=$("#mortgage_opt_in").is(":checked")?1:0;_.each(o,function(t){if(b&&(t.rentalFloorplanUnitBedrooms=b),trulia.propertyData&&(t.rentalsList1Data=t.rentalsList1Data?t.rentalsList1Data+";":"",t.rentalsList1Data+=trulia.propertyData.get().isTruliaRoomForRent?"roomforrent|1":"roomforrent|0"),"undefined"!=typeof trulia.srp&&t.isRental){var o=h&&p,n="single";t.isRentalCommunity&&(n="community"),"function"==typeof trulia.analytics.trackAction&&trulia.analytics.trackAction({pageDetails:"stand alone lead form",interactedWith:o?"property card:lead submit cta":"bottom page:lead sent",leadEnd:"1",listingType:"rental|apartment|"+n,formAttributes:g(o,d,c)})}else o_track_lead_email_sent(l?l:"LeadAskQuestion",u,{broker_id:m,plan_id:v,type_id:w,prequal_checked:e,renter_resume_checked:c,renter_resume_visible:d,one_click_checked:p,one_click_visible:h},t);trulia.PixelTracking.firePixel(trulia.PixelTracking.TYPE_REG_LEAD_CONVERSION),trulia.PixelTracking.firePixel(trulia.PixelTracking.TYPE_QC_CONVERSION),t.isBuilder&&trulia.PixelTracking.firePixel(trulia.PixelTracking.TYPE_BUILDER_SEM_CONVERSION),t.isRental&&trulia.PixelTracking.firePixel(trulia.PixelTracking.TYPE_RENTALS_SEM_CONVERSION)})}),this.customPostSendAgentEmailCallback&&this.customPostSendAgentEmailCallback(a),r||"mytrulia"==trulia.page_name||(e.showMovingPostLeadSequence(a)?(e.shouldSkipMovingServicesForm()||e.showRentalPostLeadMovingServicesForm(a,function(){show_generic_popup("Success!","Thank you, your message has been sent.")}),e.refreshMovingServicesMoveInDatePostLeadForms(a)):e.showRecommendedPropertiesPostLeadSequence()?e.showRentalPropertyRecommenderForm(a,function(){show_generic_popup("Success!","Thank you, your message has been sent.")}):e.showRecommendedPropertiesResponsivePostLeadSequence()?e.showRentalPropertyResponsiveRecommenderForm(a,function(){show_generic_popup("Success!","Thank you, your message has been sent.")}):e.showEmptyPropertiesPostLeadSequence()&&show_generic_popup("Success!","Thank you, your message has been sent.")))},e.prepareLeadRecommenderBypassElements=function(){var e=Backbone.View.extend({initialize:function(){if(_.bindAll(this,"modal_open","toggle_propertyIds","set_property_ids"),this.$form=this.options.closestForm,this.$showProperties=this.options.showProperties,this.$checkBox=this.options.checkBox,!this.$form[0].u_move_in_date)var e=new Date,t=new Date(e.setDate(e.getDate()+30)),o=("0"+(t.getMonth()+1)).slice(-2)+"/"+("0"+t.getDate()).slice(-2)+"/"+t.getFullYear(),n=$('<input type="hidden" name="u_move_in_date" value="'+o+'" />').insertAfter(this.$showProperties);this.set_property_ids()},events:function(){return this.$showProperties.off("click").on("click",this.modal_open),this.$checkBox.off("change").on("change",this.toggle_propertyIds),{"click .leadRecommenderBypassClose":"modal_close"}},modal_open:function(e){o_track_ql_click("BypassLeadRecommenderMoreInfo"),e.preventDefault(),e.stopPropagation(),this.$el.modal({fixed:!0,overlay:"dark",closeable:!0,width:440}),this.$el.modal("open")},modal_close:function(e){e.stopPropagation(),e.preventDefault(),this.$el.modal("close")},set_property_ids:function(){var e=this.$checkBox,t=this.$form.find(".propertyIdsField"),o=this.$form.find(".linkTypeField");e.is(":checked")?(t.val(t.data("recommendedPropertyIds")),o.val(o.data("bypassCheckedValue"))):(t.val(t.data("originalPropertyId")),o.val(o.data("bypassUncheckedValue")))},toggle_propertyIds:function(){var e=this.$checkBox,t=this.$form.find(".propertyIdsField"),o=this.$form.find(".linkTypeField");e.is(":checked")?(t.val(t.data("recommendedPropertyIds")),o.val(o.data("bypassCheckedValue")),o_track_ql_click("BypassLeadRecommenderChecked")):(t.val(t.data("originalPropertyId")),o.val(o.data("bypassUncheckedValue")),o_track_ql_click("BypassLeadRecommenderUnchecked"))}});$(".leadRecommenderBypassShowProperties").each(function(){var t=$(this),o=t.closest("form"),n=o.find(".leadRecommenderBypassProperties"),i=o.find(".leadRecommenderBypassCheckbox"),a;a=new e({el:n,showProperties:t,closestForm:o,checkBox:i})})},e.isSubmitButtonDisabled=function(e){return e.find("input[type=submit]").hasClass("btnDisable")||e.data("request-sent")===!0?!0:!1},e.hideSendingRequestSpinner=function(e){e.find(".send_email_to_agent_loader").hide(),e.find(".send_email_to_agent_button").show()},e.showSendingRequestSpinner=function(e){e.find(".send_email_to_agent_loader").show(),e.find(".send_email_to_agent_button").hide()},e.setFormAsRequestSent=function(e){e.data("request-sent",!0)},e.disablePopupTriggerSubmitButtons=function(){this.disableSubmitButton($(".property-bar-contact,.contact_button.quick_connect,#photoPlayerModal .contact_button"),"Request Sent")},e.disableSubmitButton=function(e,t){return e&&e.length?(e.attr("disabled",!0).removeClass("btnPrimary oldPdpButton").addClass("btnDisabled btn"),t&&(e.is("input")?e.val(t):e.is("button")&&e.html(t)),e.trigger("submitButton:disable"),!0):!1},e.enableSubmitButton=function(e,t){return e&&e.length?(e.attr("disabled",!1).addClass("btnPrimary").removeClass("btnDisabled"),t&&(e.is("input")?e.val(t):e.is("button")&&e.html(t)),!0):!1},e}(),trulia.ready(function(){trulia.ContactUser.initialize_lead_form($("body")),$("[data-role=one_click_checkbox]").each(function(){initOneClickCheckbox($(this))}),$(".propertyList").on("click",".rentalFloorplan .linkForward",function(e){var t=$(e.currentTarget).closest("[data-floorplan]").data("floorplan"),o=$(e.currentTarget).closest(".propertyCard").data();o={id:o.propertyId,stateCode:o.stateCode,status:o.status,locationId:o.locationId,city:o.city,popupType:"undefined"!=typeof t?"RentalCommunityFloorPlanForm":"",popupData:t};var n=function(){trulia.ContactUser.trackContactButtonClick("SRPv2.0|ForRent|ResultsCard|ContactProperty")};trulia.ContactUser.showContactAgentPopup(o,"srp_rental_contact","","Contact Property","","",n)})}),define("combo/voices_combined",["require","library/trulia.tooltips","trulia.voices","qa","site_js/library/trulia.dom","trulia.follow_area","trulia.follow_question","trulia.voices_comments","trulia.just_posted_or_asked","site_js/library/trulia.forms","library/trulia.content_rating_widget","deprecated/trulia.send_to_friend","site_js/trulia.contact_property"],function(e){e("library/trulia.tooltips"),e("trulia.voices"),e("qa"),e("site_js/library/trulia.dom"),e("trulia.follow_area"),e("trulia.follow_question"),e("trulia.voices_comments"),e("trulia.just_posted_or_asked"),e("site_js/library/trulia.forms"),e("library/trulia.content_rating_widget"),e("deprecated/trulia.send_to_friend"),e("site_js/trulia.contact_property")});